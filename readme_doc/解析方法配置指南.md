# RAGFlow解析方法配置相关文件位置

根据对代码库的分析，以下是配置"解析方法"及相关参数的关键文件和位置，分为前端和后端两部分：

## 前端文件

### UI 组件文件

1. **核心配置组件:**
   - `ragflow/web/src/components/chunk-method-modal/index.tsx` - 解析方法主配置模态窗
   - `ragflow/web/src/components/parse-configuration/index.tsx` - RAPTOR策略配置组件
   - `ragflow/web/src/components/parse-configuration/graph-rag-items.tsx` - 知识图谱相关配置

2. **特定类型配置组件:**
   - `ragflow/web/src/pages/add-knowledge/components/knowledge-setting/configuration/*.tsx` - 各种文档类型的配置组件:
     - `naive.tsx` - 通用文档配置
     - `paper.tsx` - 论文文档配置
     - `book.tsx` - 书籍文档配置
     - `presentation.tsx` - 演示文稿配置
     - `audio.tsx` - 音频文档配置
     - `manual.tsx` - 手册文档配置
     - 等其他文档类型配置

3. **表单元素组件:**
   - `ragflow/web/src/components/delimiter.tsx` - 分隔符配置组件
   - `ragflow/web/src/components/max-token-number.tsx` - Token数量配置组件
   - `ragflow/web/src/components/layout-recognize.tsx` - 布局识别配置组件
   - `ragflow/web/src/components/auto-keywords-item.tsx` - 自动关键词配置组件
   - `ragflow/web/src/components/entity-types-item.tsx` - 实体类型配置组件

### 配置类型定义文件

1. **常量和枚举:**
   - `ragflow/web/src/constants/knowledge.ts` - 包含文档解析器类型(DocumentParserType)定义
   - `ragflow/web/src/constants/common.ts` - 通用常量定义

2. **类型接口:**
   - `ragflow/web/src/interfaces/database/document.ts` - 定义IParserConfig接口
   - `ragflow/web/src/interfaces/request/document.ts` - API请求接口定义

3. **国际化文件:**
   - `ragflow/web/src/locales/zh.ts` - 中文翻译文件，包含解析方法相关文本
   - `ragflow/web/src/locales/en.ts` - 英文翻译文件

### API 调用文件

- `ragflow/web/src/hooks/document-hooks.ts` - 文档相关API调用钩子
- `ragflow/web/src/components/chunk-method-modal/hooks.ts` - 解析方法钩子函数

## 后端文件

### API 接口文件

- `ragflow/api/apps/chunk_app.py` - 处理分块方法的API接口
- `ragflow/api/apps/api_app.py` - API路由配置

### 解析器实现文件

1. **解析器核心:**
   - `ragflow/deepdoc/parser/pdf_parser.py` - PDF文档解析器
   - `ragflow/deepdoc/parser/txt_parser.py` - 文本文档解析器

2. **OCR和布局识别:**
   - `ragflow/deepdoc/vision/ocr.py` - OCR文本识别实现
   - `ragflow/deepdoc/vision/recognizer.py` - 识别器实现
   - `ragflow/deepdoc/vision/operators.py` - 视觉处理算子
   - `ragflow/deepdoc/vision/table_structure_recognizer.py` - 表格结构识别器

3. **Raptor策略处理:**
   - `ragflow/rag/raptor.py` - 实现RAPTOR策略的核心逻辑
   - `ragflow/rag/prompts.py` - 提示词模板

4. **知识图谱处理:**
   - `ragflow/graphrag/general/extractor.py` - 实体抽取器
   - `ragflow/graphrag/general/community_reports_extractor.py` - 社区报告提取器
   - `ragflow/graphrag/utils.py` - 图谱工具函数

### 数据处理和存储文件

- `ragflow/rag/app/table.py` - 表格数据处理
- `ragflow/rag/app/tag.py` - 标签处理
- `ragflow/rag/utils/infinity_conn.py` - Infinity数据库连接器
- `ragflow/rag/utils/storage_factory.py` - 存储工厂类

## 配置流程

当用户在前端配置解析方法时，数据流向如下：

1. 用户在`ChunkMethodModal`组件中设置解析方法参数
2. 前端将配置通过API发送到后端`chunk_app.py`
3. 后端将配置保存并应用于文档处理流程
4. 当文档被处理时，相应的解析器(如`pdf_parser.py`)会读取这些配置并执行相应的处理逻辑

这些文件共同组成了RAGFlow的文档解析配置系统，允许用户根据不同文档类型和需求自定义处理流程。

# RAGFlow解析方法及参数配置指南

RAGFlow中的"解析方法"（Chunk Method）是文档处理和知识库建立的核心配置，它决定了如何将文档切分和解析为可检索的知识片段。以下是在RAGFlow中设置这些参数的方法：

## 在界面中配置解析方法

这些配置都在知识库设置中的"解析方法"模态框中进行设置，您可以通过以下步骤访问：

1. 进入您的知识库详情页面
2. 点击"解析方法"按钮打开配置窗口
3. 从下拉菜单中选择适合您文档类型的解析方法（如通用、论文、书籍等）

## 参数配置说明

### 基本配置

- **页码范围**：适用于PDF文档，设置需要处理的页面范围（默认为1-1000000）
- **布局识别和OCR**：启用对文档布局的智能识别和OCR处理
  - 启用后可配置**任务页面大小**（默认12）：控制并行处理的页面组大小
- **块Token数**：设置每个知识块的最大Token数（默认128）
- **分段标识符**：自定义文本分段的标识符（如`\n!?;。；！？`）

### Raptor增强策略

- **使用召回增强RAPTOR策略**：启用智能聚类和总结功能
  - **提示词**：设置摘要生成的提示词模板
  - **最大token数**：设置生成摘要的最大token长度（默认256）
  - **阈值**：聚类相似度阈值（默认0.10）
  - **最大聚类数**：最多生成的聚类数量（默认64）
  - **随机种子**：控制聚类的随机性（默认0）

### 知识图谱提取

- **提取知识图谱**：启用实体和关系的自动提取
  - **实体类型**：选择需要提取的实体类型（组织、人物、地理位置、事件、类别）
  - **方法**：选择实体归一化方法
  - **社区报告生成**：启用自动生成社区报告功能

### 自动生成功能

- **自动关键词**：设置自动提取的关键词数量（默认0）
- **自动问题**：设置自动生成的问题数量（默认0）

## 如何应用这些配置

在RAGFlow中，这些配置参数会被存储在知识库的`parser_config`对象中，并在文档处理过程中被使用。当您上传新文档或更新现有文档的处理方式时，这些参数将决定文档如何被解析和索引。

不同类型的文档（PDF、XLSX、文本等）支持的参数有所不同，界面会根据文档类型和选择的解析方法动态显示相关配置项。例如，"布局识别"选项仅在处理PDF文档时显示，而"Excel转HTML"选项仅在处理Excel文件时可用。

这些配置的正确设置对于提高RAG系统的检索质量和回答准确性至关重要，建议根据您的具体使用场景和文档特性进行调整。