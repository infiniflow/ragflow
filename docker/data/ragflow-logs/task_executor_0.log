2025-03-01 15:41:51,896 INFO     24 task_executor_0 log path: /ragflow/logs/task_executor_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2025-03-01 15:41:52,265 INFO     24 init database on cluster mode successfully
2025-03-01 15:42:01,060 INFO     24 TextRecognizer det uses CPU
2025-03-01 15:42:01,205 INFO     24 TextRecognizer rec uses CPU
2025-03-01 15:42:01,236 INFO     24 
  ______           __      ______                     __            
 /_  __/___ ______/ /__   / ____/  _____  _______  __/ /_____  _____
  / / / __ `/ ___/ //_/  / __/ | |/_/ _ \/ ___/ / / / __/ __ \/ ___/
 / / / /_/ (__  ) ,<    / /____>  </  __/ /__/ /_/ / /_/ /_/ / /    
/_/  \__,_/____/_/|_|  /_____/_/|_|\___/\___/\__,_/\__/\____/_/                               
    
2025-03-01 15:42:01,238 INFO     24 TaskExecutor: RAGFlow version: v0.16.0 slim
2025-03-01 15:42:01,239 INFO     24 Use Elasticsearch http://es01:9200 as the doc engine.
2025-03-01 15:42:01,250 INFO     24 GET http://es01:9200/ [status:200 duration:0.009s]
2025-03-01 15:42:01,255 INFO     24 HEAD http://es01:9200/ [status:200 duration:0.003s]
2025-03-01 15:42:01,256 INFO     24 Elasticsearch http://es01:9200 is healthy.
2025-03-01 15:42:01,266 WARNING  24 Load term.freq FAIL!
2025-03-01 15:42:01,271 WARNING  24 Realtime synonym is disabled, since no redis connection.
2025-03-01 15:42:01,277 WARNING  24 Load term.freq FAIL!
2025-03-01 15:42:01,281 WARNING  24 Realtime synonym is disabled, since no redis connection.
2025-03-01 15:42:01,282 INFO     24 MAX_CONTENT_LENGTH: 134217728
2025-03-01 15:42:01,283 INFO     24 SERVER_QUEUE_MAX_LEN: 1024
2025-03-01 15:42:01,284 INFO     24 SERVER_QUEUE_RETENTION: 3600
2025-03-01 15:42:01,285 INFO     24 MAX_FILE_COUNT_PER_USER: 0
2025-03-01 15:42:01,300 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:42:01,303 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:42:01.299+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:42:31,315 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:42:31,317 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:42:31.314+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:43:01,349 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:43:01,351 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:43:01.348+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:43:31,381 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:43:31,383 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:43:31.381+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:44:01,414 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:44:01,416 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:44:01.414+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:44:31,446 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:44:31,448 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:44:31.446+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:45:01,478 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:45:01,480 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:45:01.478+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:45:31,506 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:45:31,509 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:45:31.506+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:46:01,540 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:46:01,542 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:46:01.539+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:46:31,568 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:46:31,570 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:46:31.568+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:47:01,601 WARNING  24 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:47:01,603 INFO     24 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:47:01.600+08:00", "boot_at": "2025-03-01T15:42:01.236+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:47:17,857 ERROR    24 RedisDB.get_unacked_for task_consumer_0 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1116, in get_connection
    if connection.can_read() and connection.client_cache is None:
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 524, in can_read
    return self._parser.can_read(timeout)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/_parsers/base.py", line 128, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/_parsers/socket.py", line 95, in can_read
    return bool(self.unread_bytes()) or self._read_from_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/_parsers/socket.py", line 68, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
valkey.exceptions.ConnectionError: Connection closed by server.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 244, in get_unacked_for
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1120, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-03-01 15:47:17,882 ERROR    24 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 213, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-03-01 15:47:22,659 ERROR    24 RedisDB.get_unacked_for task_consumer_0 got exception: Error -2 connecting to redis:6379. Name or service not known.
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 696, in _connect
    for res in socket.getaddrinfo(
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 244, in get_unacked_for
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error -2 connecting to redis:6379. Name or service not known.
2025-03-01 15:47:26,389 ERROR    24 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error -2 connecting to redis:6379. Name or service not known.
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 696, in _connect
    for res in socket.getaddrinfo(
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 213, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error -2 connecting to redis:6379. Name or service not known.
2025-03-01 15:57:00,208 INFO     17 task_executor_0 log path: /ragflow/logs/task_executor_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2025-03-01 15:57:00,687 INFO     17 init database on cluster mode successfully
2025-03-01 15:57:09,587 INFO     17 TextRecognizer det uses CPU
2025-03-01 15:57:09,724 INFO     17 TextRecognizer rec uses CPU
2025-03-01 15:57:09,752 INFO     17 
  ______           __      ______                     __            
 /_  __/___ ______/ /__   / ____/  _____  _______  __/ /_____  _____
  / / / __ `/ ___/ //_/  / __/ | |/_/ _ \/ ___/ / / / __/ __ \/ ___/
 / / / /_/ (__  ) ,<    / /____>  </  __/ /__/ /_/ / /_/ /_/ / /    
/_/  \__,_/____/_/|_|  /_____/_/|_|\___/\___/\__,_/\__/\____/_/                               
    
2025-03-01 15:57:09,754 INFO     17 TaskExecutor: RAGFlow version: v0.16.0 slim
2025-03-01 15:57:09,755 INFO     17 Use Elasticsearch http://es01:9200 as the doc engine.
2025-03-01 15:57:09,766 INFO     17 GET http://es01:9200/ [status:200 duration:0.009s]
2025-03-01 15:57:09,771 INFO     17 HEAD http://es01:9200/ [status:200 duration:0.003s]
2025-03-01 15:57:09,772 INFO     17 Elasticsearch http://es01:9200 is healthy.
2025-03-01 15:57:09,777 WARNING  17 Load term.freq FAIL!
2025-03-01 15:57:09,781 WARNING  17 Realtime synonym is disabled, since no redis connection.
2025-03-01 15:57:09,786 WARNING  17 Load term.freq FAIL!
2025-03-01 15:57:09,790 WARNING  17 Realtime synonym is disabled, since no redis connection.
2025-03-01 15:57:09,791 INFO     17 MAX_CONTENT_LENGTH: 134217728
2025-03-01 15:57:09,793 INFO     17 SERVER_QUEUE_MAX_LEN: 1024
2025-03-01 15:57:09,794 INFO     17 SERVER_QUEUE_RETENTION: 3600
2025-03-01 15:57:09,794 INFO     17 MAX_FILE_COUNT_PER_USER: 0
2025-03-01 15:57:09,822 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:57:09,825 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:57:09.822+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:57:39,852 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:57:39,854 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:57:39.851+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:58:09,885 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:58:09,886 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:58:09.884+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:58:39,909 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:58:39,911 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:58:39.908+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:59:09,941 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:59:09,943 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:59:09.941+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 15:59:39,945 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 15:59:39,947 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T15:59:39.944+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:00:09,974 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:00:09,976 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:00:09.973+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:00:40,007 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:00:40,010 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:00:40.006+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:01:10,042 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:01:10,044 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:01:10.041+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:01:40,060 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:01:40,062 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:01:40.060+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:02:10,093 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:02:10,095 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:02:10.092+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:02:40,113 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:02:40,115 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:02:40.112+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:03:10,123 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:03:10,126 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:03:10.122+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:03:40,156 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:03:40,159 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:03:40.155+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 16:04:10,187 WARNING  17 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 16:04:10,189 INFO     17 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T16:04:10.186+08:00", "boot_at": "2025-03-01T15:57:09.752+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:09:29,292 INFO     16 task_executor_0 log path: /ragflow/logs/task_executor_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2025-03-01 18:09:29,785 INFO     16 init database on cluster mode successfully
2025-03-01 18:09:38,122 INFO     16 TextRecognizer det uses CPU
2025-03-01 18:09:38,242 INFO     16 TextRecognizer rec uses CPU
2025-03-01 18:09:38,267 INFO     16 
  ______           __      ______                     __            
 /_  __/___ ______/ /__   / ____/  _____  _______  __/ /_____  _____
  / / / __ `/ ___/ //_/  / __/ | |/_/ _ \/ ___/ / / / __/ __ \/ ___/
 / / / /_/ (__  ) ,<    / /____>  </  __/ /__/ /_/ / /_/ /_/ / /    
/_/  \__,_/____/_/|_|  /_____/_/|_|\___/\___/\__,_/\__/\____/_/                               
    
2025-03-01 18:09:38,268 INFO     16 TaskExecutor: RAGFlow version: v0.16.0 slim
2025-03-01 18:09:38,269 INFO     16 Use Elasticsearch http://es01:9200 as the doc engine.
2025-03-01 18:09:38,281 INFO     16 GET http://es01:9200/ [status:200 duration:0.010s]
2025-03-01 18:09:38,286 INFO     16 HEAD http://es01:9200/ [status:200 duration:0.003s]
2025-03-01 18:09:38,287 INFO     16 Elasticsearch http://es01:9200 is healthy.
2025-03-01 18:09:38,292 WARNING  16 Load term.freq FAIL!
2025-03-01 18:09:38,296 WARNING  16 Realtime synonym is disabled, since no redis connection.
2025-03-01 18:09:38,300 WARNING  16 Load term.freq FAIL!
2025-03-01 18:09:38,303 WARNING  16 Realtime synonym is disabled, since no redis connection.
2025-03-01 18:09:38,304 INFO     16 MAX_CONTENT_LENGTH: 134217728
2025-03-01 18:09:38,305 INFO     16 SERVER_QUEUE_MAX_LEN: 1024
2025-03-01 18:09:38,305 INFO     16 SERVER_QUEUE_RETENTION: 3600
2025-03-01 18:09:38,306 INFO     16 MAX_FILE_COUNT_PER_USER: 0
2025-03-01 18:09:38,326 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:09:38,329 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:09:38.326+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:10:08,363 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:10:08,365 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:10:08.363+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:10:38,392 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:10:38,394 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:10:38.392+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:11:08,425 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:11:08,427 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:11:08.425+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:11:38,447 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:11:38,449 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:11:38.447+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:12:08,473 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:12:08,475 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:12:08.472+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:12:38,504 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:12:38,506 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:12:38.503+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:13:08,536 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:13:08,538 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:13:08.536+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:13:38,569 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:13:38,571 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:13:38.569+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:14:08,596 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:14:08,598 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:14:08.596+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:14:38,625 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:14:38,627 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:14:38.624+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:15:08,656 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:15:08,658 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:15:08.656+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:15:38,682 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:15:38,684 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:15:38.682+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:16:08,714 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:16:08,716 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:16:08.713+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:16:38,733 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:16:38,734 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:16:38.732+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:17:08,766 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:17:08,767 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:17:08.765+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:17:38,773 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:17:38,775 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:17:38.773+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:18:08,806 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:18:08,808 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:18:08.805+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:18:38,823 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:18:38,825 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:18:38.823+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:19:08,854 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:19:08,856 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:19:08.854+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:19:38,886 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:19:38,888 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:19:38.886+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:20:08,919 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:20:08,921 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:20:08.919+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:20:38,951 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:20:38,953 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:20:38.951+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:21:08,967 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:21:08,973 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:21:08.966+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:21:39,004 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:21:39,005 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:21:39.003+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:22:09,037 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:22:09,039 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:22:09.037+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:22:39,047 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:22:39,049 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:22:39.046+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:23:09,079 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:23:09,081 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:23:09.079+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:23:39,112 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:23:39,113 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:23:39.111+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:24:09,144 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:24:09,146 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:24:09.144+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:24:39,177 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:24:39,178 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:24:39.176+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:25:09,209 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:25:09,211 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:25:09.209+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:25:39,242 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:25:39,243 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:25:39.241+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:26:09,266 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:26:09,268 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:26:09.266+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:26:39,299 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:26:39,301 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:26:39.298+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:27:09,317 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:27:09,319 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:27:09.317+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:27:39,350 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:27:39,352 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:27:39.350+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:28:09,383 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:28:09,385 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:28:09.383+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:28:39,391 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:28:39,393 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:28:39.391+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:29:09,410 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:29:09,412 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:29:09.409+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:29:39,442 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:29:39,444 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:29:39.442+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:30:09,475 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:30:09,476 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:30:09.474+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:30:39,506 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:30:39,508 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:30:39.506+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:31:09,539 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:31:09,541 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:31:09.539+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:31:39,564 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:31:39,566 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:31:39.564+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:32:09,587 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:32:09,589 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:32:09.587+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:32:39,593 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:32:39,595 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:32:39.593+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:33:09,625 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:33:09,627 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:33:09.625+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:33:39,649 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:33:39,651 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:33:39.649+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:34:09,681 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:34:09,683 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:34:09.681+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:34:39,697 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:34:39,699 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:34:39.697+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:35:09,730 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:35:09,731 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:35:09.729+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:35:39,762 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:35:39,764 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:35:39.761+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:36:09,794 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:36:09,796 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:36:09.794+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:36:39,815 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:36:39,817 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:36:39.815+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:37:09,848 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:37:09,850 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:37:09.847+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:37:39,855 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:37:39,857 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:37:39.855+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:38:09,877 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:38:09,879 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:38:09.877+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:38:39,897 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:38:39,898 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:38:39.896+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:39:09,929 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:39:09,931 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:39:09.928+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:39:39,962 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:39:39,963 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:39:39.962+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:40:09,994 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:40:09,996 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:40:09.994+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:40:40,026 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:40:40,028 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:40:40.026+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:41:10,051 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:41:10,052 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:41:10.050+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:41:40,083 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:41:40,085 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:41:40.082+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:42:10,116 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:42:10,119 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:42:10.116+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:42:40,150 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:42:40,152 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:42:40.149+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:43:10,177 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:43:10,178 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:43:10.176+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:43:40,184 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:43:40,186 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:43:40.184+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:44:10,192 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:44:10,194 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:44:10.191+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:44:40,224 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:44:40,226 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:44:40.223+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:45:10,254 WARNING  16 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2025-03-01 18:45:10,255 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:45:10.253+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": null}
2025-03-01 18:45:24,603 INFO     16 handle_task begin for task {"id": "472f4fe0f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923278, "task_type": ""}
2025-03-01 18:45:25,656 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:404 duration:0.141s]
2025-03-01 18:45:28,851 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:200 duration:3.109s]
2025-03-01 18:45:28,969 INFO     16 From minio(0.11568025900123757) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 18:45:29,472 INFO     16 TextRecognizer det uses CPU
2025-03-01 18:45:29,674 INFO     16 TextRecognizer rec uses CPU
2025-03-01 18:45:31,823 INFO     16 Recognizer layout uses CPU
2025-03-01 18:45:31,946 INFO     16 Recognizer tsr uses CPU
2025-03-01 18:45:34,429 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:45:34 Page(1~13): OCR started
2025-03-01 18:45:40,241 WARNING  16 Miss outlines
2025-03-01 18:45:40,300 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:45:40.290+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 6, "done": 0, "failed": 0, "current": {"id": "472f4fe0f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923278, "task_type": ""}}
2025-03-01 18:45:43,874 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.3, progress_msg: 
2025-03-01 18:45:47,376 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.6, progress_msg: 
2025-03-01 18:45:47,401 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:45:47 Page(1~13): OCR finished (12.97s)
2025-03-01 18:45:47,411 INFO     16 OCR(0~12): 12.99s
2025-03-01 18:46:01,630 WARNING  16 /ragflow/.venv/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,

2025-03-01 18:46:01,633 WARNING  16 /ragflow/.venv/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)

2025-03-01 18:46:01,691 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.63, progress_msg: 18:46:01 Page(1~13): Layout analysis (14.27s)
2025-03-01 18:46:01,712 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.65, progress_msg: 18:46:01 Page(1~13): Table analysis (0.00s)
2025-03-01 18:46:01,733 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.67, progress_msg: 18:46:01 Page(1~13): Text merged (0.00s)
2025-03-01 18:46:01,763 WARNING  16 Missing layout match: 6,figure caption-0
2025-03-01 18:46:01,766 WARNING  16 Missing layout match: 7,figure-0
2025-03-01 18:46:02,494 INFO     16 layouts cost: 28.07049835900034s
2025-03-01 18:46:04,244 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 1.5271217139998043
2025-03-01 18:46:04,246 INFO     16 Chunking(35.39334842900098) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 18:46:04,837 INFO     16 MINIO PUT(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf):0.40966423799727636
2025-03-01 18:46:04,839 INFO     16 Build document 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf: 35.99s
2025-03-01 18:46:04,845 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:46:04 Page(1~13): Generate 36 chunks
2025-03-01 18:46:05,755 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.7055555555555555, progress_msg: 
2025-03-01 18:46:06,191 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.7944444444444444, progress_msg: 
2025-03-01 18:46:06,553 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.8833333333333333, progress_msg: 
2025-03-01 18:46:06,570 INFO     16 Embedding chunks (1.72s)
2025-03-01 18:46:06,578 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:46:06 Page(1~13): Embedding chunks (1.72s)
2025-03-01 18:46:07,118 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.521s]
2025-03-01 18:46:07,124 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 0.8027777777777778, progress_msg: 
2025-03-01 18:46:07,182 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.038s]
2025-03-01 18:46:07,245 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.052s]
2025-03-01 18:46:07,294 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.036s]
2025-03-01 18:46:07,382 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.075s]
2025-03-01 18:46:07,442 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.047s]
2025-03-01 18:46:07,497 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.039s]
2025-03-01 18:46:07,553 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.043s]
2025-03-01 18:46:07,617 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.052s]
2025-03-01 18:46:07,626 INFO     16 Indexing doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(0-12), chunks(36), elapsed: 1.04
2025-03-01 18:46:07,650 INFO     16 set_progress(472f4fe0f68a11ef9eea0242ac120006), progress: 1.0, progress_msg: 18:46:07 Page(1~13): Done (1.06s)
2025-03-01 18:46:07,666 INFO     16 Chunk doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(0-12), chunks(36), token(4191), elapsed:1.06
2025-03-01 18:46:07,669 INFO     16 handle_task done for task {"id": "472f4fe0f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923278, "task_type": ""}
2025-03-01 18:46:07,689 INFO     16 handle_task begin for task {"id": "472f9608f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923280, "task_type": ""}
2025-03-01 18:46:07,981 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:200 duration:0.014s]
2025-03-01 18:46:08,004 INFO     16 From minio(0.022062046999053564) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 18:46:08,074 INFO     16 TextRecognizer det uses CPU
2025-03-01 18:46:08,157 INFO     16 TextRecognizer rec uses CPU
2025-03-01 18:46:08,480 INFO     16 Recognizer layout uses CPU
2025-03-01 18:46:08,541 INFO     16 Recognizer tsr uses CPU
2025-03-01 18:46:08,574 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:46:08 Page(13~25): OCR started
2025-03-01 18:46:10,346 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:46:10.335+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 1, "failed": 0, "current": {"id": "472f9608f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923280, "task_type": ""}}
2025-03-01 18:46:11,791 WARNING  16 Miss outlines
2025-03-01 18:46:15,689 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: 0.3, progress_msg: 
2025-03-01 18:46:18,928 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: 0.6, progress_msg: 
2025-03-01 18:46:18,942 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:46:18 Page(13~25): OCR finished (10.37s)
2025-03-01 18:46:18,951 INFO     16 OCR(12~24): 10.38s
2025-03-01 18:46:54,648 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:46:53.873+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 1, "failed": 0, "current": {"id": "472f9608f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923280, "task_type": ""}}
2025-03-01 18:47:09,712 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: 0.63, progress_msg: 18:47:09 Page(13~25): Layout analysis (50.70s)
2025-03-01 18:47:10,210 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: 0.65, progress_msg: 18:47:10 Page(13~25): Table analysis (0.46s)
2025-03-01 18:47:10,233 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: 0.67, progress_msg: 18:47:10 Page(13~25): Text merged (0.00s)
2025-03-01 18:47:12,028 INFO     16 layouts cost: 63.47059513699969s
2025-03-01 18:47:19,115 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 6.943610448999607
2025-03-01 18:47:19,135 INFO     16 Chunking(71.16535334999935) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 18:47:20,823 INFO     16 MINIO PUT(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf):1.3187170389992389
2025-03-01 18:47:20,827 INFO     16 Build document 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf: 72.86s
2025-03-01 18:47:20,859 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: None, progress_msg: 18:47:20 Page(13~25): Generate 54 chunks
2025-03-01 18:55:01,608 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:01 Page(13~25): [ERROR]Generate embedding error:HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:01,804 ERROR    16 Generate embedding error:HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 571, in do_handle_task
    token_count, vector_size = embedding(chunks, embedding_model, task_parser_config, progress_callback)
  File "/ragflow/rag/svr/task_executor.py", line 368, in embedding
    vts, c = mdl.encode(cnts[i: i + batch_size])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:28,632 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:55:03.749+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 1, "failed": 0, "current": {"id": "472f9608f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923280, "task_type": ""}}
2025-03-01 18:55:28,800 INFO     16 set_progress(472f9608f68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:28 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:29,222 ERROR    16 handle_task got exception for task {"id": "472f9608f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923280, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 571, in do_handle_task
    token_count, vector_size = embedding(chunks, embedding_model, task_parser_config, progress_callback)
  File "/ragflow/rag/svr/task_executor.py", line 368, in embedding
    vts, c = mdl.encode(cnts[i: i + batch_size])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dcee0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:29,859 INFO     16 handle_task begin for task {"id": "472f970cf68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923281, "task_type": ""}
2025-03-01 18:55:30,318 INFO     16 set_progress(472f970cf68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:30 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd210>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:30,452 ERROR    16 handle_task got exception for task {"id": "472f970cf68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923281, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3dd210>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd210>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd210>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:30,504 INFO     16 handle_task begin for task {"id": "472f9798f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923282, "task_type": ""}
2025-03-01 18:55:30,555 INFO     16 set_progress(472f9798f68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:30 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3ddb10>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:30,840 ERROR    16 handle_task got exception for task {"id": "472f9798f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923282, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3ddb10>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3ddb10>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3ddb10>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:30,980 INFO     16 handle_task begin for task {"id": "472f9824f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923283, "task_type": ""}
2025-03-01 18:55:31,072 INFO     16 set_progress(472f9824f68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:31 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd060>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:31,135 ERROR    16 handle_task got exception for task {"id": "472f9824f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923283, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3dd060>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd060>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd060>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:31,180 INFO     16 handle_task begin for task {"id": "472f98b0f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 60, "to_page": 72, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923284, "task_type": ""}
2025-03-01 18:55:31,229 INFO     16 set_progress(472f98b0f68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:31 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dec80>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:31,303 ERROR    16 handle_task got exception for task {"id": "472f98b0f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 60, "to_page": 72, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923284, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3dec80>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dec80>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dec80>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:31,339 INFO     16 handle_task begin for task {"id": "472f9932f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 72, "to_page": 76, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923285, "task_type": ""}
2025-03-01 18:55:31,410 INFO     16 set_progress(472f9932f68a11ef9eea0242ac120006), progress: -1, progress_msg: 18:55:31 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd1b0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:31,476 ERROR    16 handle_task got exception for task {"id": "472f9932f68a11ef9eea0242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 72, "to_page": 76, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740825923285, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7fd99c3dd1b0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd1b0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7fda583a9cf0>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7fda5a23eb00>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fd99c3dd1b0>: Failed to resolve 'api.siliconflow.cn' ([Errno -2] Name or service not known)"))
2025-03-01 18:55:58,887 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:55:58.884+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:56:28,922 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:56:28.921+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:56:58,954 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:56:58.953+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:57:28,986 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:57:28.984+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:57:58,995 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:57:58.994+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:58:29,017 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:58:29.015+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:58:59,049 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:58:59.048+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:59:29,081 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:59:29.079+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 18:59:59,137 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T18:59:59.109+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:00:29,167 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:00:29.165+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:00:59,190 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:00:59.188+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:01:29,210 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:01:29.209+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:01:59,215 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:01:59.214+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:02:29,256 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:02:29.256+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:02:59,282 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:02:59.280+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:03:29,313 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:03:29.312+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:03:59,343 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:03:59.341+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:04:29,348 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:04:29.345+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:04:59,372 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:04:59.371+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:05:29,406 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:05:29.404+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:05:59,437 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:05:59.435+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:06:29,468 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:06:29.467+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:06:59,524 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:06:59.498+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:07:29,556 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:07:29.555+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:07:59,573 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:07:59.572+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:08:29,603 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:08:29.602+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:08:59,636 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:08:59.634+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:09:29,662 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:09:29.660+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:09:59,690 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:09:59.689+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:10:29,718 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:10:29.717+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:10:59,776 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:10:59.749+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:11:29,807 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:11:29.804+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:11:59,865 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:11:59.838+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:12:29,893 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:12:29.891+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:12:59,901 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:12:59.900+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:13:29,933 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:13:29.932+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:13:59,941 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:13:59.939+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:14:29,977 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:14:29.971+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:15:00,003 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:15:00.002+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:15:30,034 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:15:30.032+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:16:00,068 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:16:00.065+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:16:30,127 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:16:30.100+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:17:00,161 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:17:00.160+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:17:30,193 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:17:30.192+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:18:00,221 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:18:00.220+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:18:30,251 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:18:30.250+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:19:00,283 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:19:00.282+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:19:30,316 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:19:30.314+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:20:00,349 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:20:00.347+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:20:30,368 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:20:30.366+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:21:00,394 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:21:00.393+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:21:30,405 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:21:30.404+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:22:00,434 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:22:00.432+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:22:30,466 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:22:30.465+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:23:00,490 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:23:00.489+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:23:30,520 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:23:30.518+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:24:00,528 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:24:00.527+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:24:30,561 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:24:30.559+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:25:00,585 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:25:00.584+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:25:30,605 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:25:30.604+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:26:00,630 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:26:00.628+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:26:30,688 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:26:30.661+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:27:00,720 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:27:00.719+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:27:30,752 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:27:30.751+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:28:00,783 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:28:00.783+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:28:30,786 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:28:30.784+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:29:00,794 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:29:00.793+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:29:30,826 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:29:30.825+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:30:00,875 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:30:00.849+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:30:30,888 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:30:30.887+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:31:00,904 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:31:00.903+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:31:30,936 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:31:30.935+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:32:00,963 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:32:00.961+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:32:30,968 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:32:30.967+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:33:00,991 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:33:00.990+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:33:31,020 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:33:31.019+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:34:01,050 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:34:01.049+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:34:31,082 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:34:31.081+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:35:01,115 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:35:01.113+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:35:31,147 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:35:31.146+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:36:01,178 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:36:01.177+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:36:31,210 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:36:31.209+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:37:01,213 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:37:01.211+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:37:31,238 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:37:31.237+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:38:01,269 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:38:01.268+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:38:31,280 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:38:31.278+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:39:01,311 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:39:01.310+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:39:31,334 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:39:31.333+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:40:01,361 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:40:01.360+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:40:31,384 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:40:31.382+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:41:01,398 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:41:01.396+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:41:31,430 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:41:31.429+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:42:01,448 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:42:01.447+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:42:31,455 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:42:31.454+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:43:01,484 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:43:01.483+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:43:31,497 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:43:31.496+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:44:01,555 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:44:01.528+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:44:31,600 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:44:31.574+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:45:01,647 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:45:01.627+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:45:31,679 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:45:31.678+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:46:01,690 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:46:01.688+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:46:31,723 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:46:31.721+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 19:47:01,742 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T19:47:01.740+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:08:17,616 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:08:17.615+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:08:47,838 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:08:47.836+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:09:17,856 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:09:17.855+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:09:47,881 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:09:47.880+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:10:17,913 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:10:17.912+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:10:47,946 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:10:47.945+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:11:17,967 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:11:17.965+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:11:47,999 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:11:47.998+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:12:18,032 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:12:18.030+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:12:48,063 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:12:48.062+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:13:18,072 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:13:18.071+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:13:48,118 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:13:48.103+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:14:18,175 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:14:18.149+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:14:48,213 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:14:48.187+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:15:18,245 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:15:18.244+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:15:48,275 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:15:48.274+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:16:18,316 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:16:18.290+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:16:48,342 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:16:48.341+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:17:18,379 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:17:18.373+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:17:48,409 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:17:48.408+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:18:18,412 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:18:18.411+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:18:48,417 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:18:48.415+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:19:18,449 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:19:18.448+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:19:48,480 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:19:48.479+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:20:18,537 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:20:18.511+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:20:48,594 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:20:48.567+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:21:18,599 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:21:18.597+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:21:48,627 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:21:48.626+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:22:18,633 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:22:18.632+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:22:48,690 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:22:48.689+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:23:18,720 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:23:18.719+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:23:48,751 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:23:48.750+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:24:18,783 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:24:18.782+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:24:48,816 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:24:48.815+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:25:18,849 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:25:18.847+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:25:48,859 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:25:48.858+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:26:18,891 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:26:18.890+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:26:48,923 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:26:48.922+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:27:18,954 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:27:18.953+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:27:48,986 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:27:48.985+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:28:19,012 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:28:19.011+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:28:49,044 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:28:49.043+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:29:19,076 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:29:19.075+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:29:49,108 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:29:49.106+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:36:55,066 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:36:55.064+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:37:25,097 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:37:25.096+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:37:55,129 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:37:55.128+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:38:25,150 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:38:25.148+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:38:55,157 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:38:55.156+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:39:25,190 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:39:25.189+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:39:55,219 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:39:55.218+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 0, "lag": 0, "done": 1, "failed": 6, "current": null}
2025-03-01 20:40:11,402 INFO     16 handle_task begin for task {"id": "50a38bb2f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811121, "task_type": ""}
2025-03-01 20:40:12,283 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:200 duration:0.020s]
2025-03-01 20:40:12,407 INFO     16 From minio(0.11678014100107248) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 20:40:13,018 INFO     16 TextRecognizer det uses CPU
2025-03-01 20:40:13,432 INFO     16 TextRecognizer rec uses CPU
2025-03-01 20:40:16,802 INFO     16 Recognizer layout uses CPU
2025-03-01 20:40:16,955 INFO     16 Recognizer tsr uses CPU
2025-03-01 20:40:17,206 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: None, progress_msg: 20:40:17 Page(1~13): OCR started
2025-03-01 20:40:22,880 WARNING  16 Miss outlines
2025-03-01 20:40:25,299 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:40:25.258+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 6, "done": 1, "failed": 6, "current": {"id": "50a38bb2f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811121, "task_type": ""}}
2025-03-01 20:40:28,725 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.3, progress_msg: 
2025-03-01 20:40:33,470 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.6, progress_msg: 
2025-03-01 20:40:33,526 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: None, progress_msg: 20:40:33 Page(1~13): OCR finished (16.32s)
2025-03-01 20:40:33,551 INFO     16 OCR(0~12): 16.36s
2025-03-01 20:40:55,420 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:40:55.332+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 6, "done": 1, "failed": 6, "current": {"id": "50a38bb2f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811121, "task_type": ""}}
2025-03-01 20:40:58,059 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.63, progress_msg: 20:40:58 Page(1~13): Layout analysis (24.37s)
2025-03-01 20:40:58,101 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.65, progress_msg: 20:40:58 Page(1~13): Table analysis (0.00s)
2025-03-01 20:40:58,126 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.67, progress_msg: 20:40:58 Page(1~13): Text merged (0.00s)
2025-03-01 20:40:58,236 WARNING  16 Missing layout match: 6,figure caption-0
2025-03-01 20:40:58,241 WARNING  16 Missing layout match: 7,figure-0
2025-03-01 20:41:01,246 INFO     16 layouts cost: 44.055378721001034s
2025-03-01 20:41:12,063 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 10.559609677999106
2025-03-01 20:41:12,097 INFO     16 Chunking(59.81406399200205) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 20:41:14,519 INFO     16 MINIO PUT(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf):2.1373221289977664
2025-03-01 20:41:14,522 INFO     16 Build document 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf: 62.24s
2025-03-01 20:41:14,563 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: None, progress_msg: 20:41:14 Page(1~13): Generate 36 chunks
2025-03-01 20:41:15,800 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.7055555555555555, progress_msg: 
2025-03-01 20:41:16,411 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.7944444444444444, progress_msg: 
2025-03-01 20:41:16,748 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.8833333333333333, progress_msg: 
2025-03-01 20:41:16,763 INFO     16 Embedding chunks (2.18s)
2025-03-01 20:41:16,768 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: None, progress_msg: 20:41:16 Page(1~13): Embedding chunks (2.18s)
2025-03-01 20:41:16,826 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.014s]
2025-03-01 20:41:16,831 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-03-01 20:41:16,834 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda218d19c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,869 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.005s]
2025-03-01 20:41:16,870 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-03-01 20:41:16,871 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f340>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,875 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,877 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-03-01 20:41:16,878 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724fac0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,884 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:41:16,885 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-03-01 20:41:16,888 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda218d19c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:16,907 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,908 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-03-01 20:41:16,909 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8070>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,913 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,914 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,915 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8220>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,921 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:16,922 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,923 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8400>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,927 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,928 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,930 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8070>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:16,938 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 0.8027777777777778, progress_msg: 
2025-03-01 20:41:16,968 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,970 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,971 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724ff10>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,974 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,975 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,977 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f0a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,980 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:16,981 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,982 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724fa30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:16,985 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,986 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,988 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724ff10>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:16,993 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:16,995 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 13 times in a row, putting on 30 second timeout
2025-03-01 20:41:16,996 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8940>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,001 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,002 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 14 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,003 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe87f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,007 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,008 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 15 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,009 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8b80>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,012 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,013 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 16 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,015 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8940>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,035 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,036 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 17 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,038 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8df0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,041 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,042 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 18 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,044 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8670>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,047 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,048 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 19 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,050 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe81c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,054 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,055 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 20 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,057 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8df0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,064 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,066 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 21 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,068 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9390>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,071 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,073 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 22 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,074 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724ef50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,078 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,079 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 23 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,081 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724ef20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,086 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,087 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 24 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,089 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9390>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,103 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,105 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 25 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,106 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724eef0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,109 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,111 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 26 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,112 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe95a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,115 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,117 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 27 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,118 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8070>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,121 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,122 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 28 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,124 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724eef0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,128 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,130 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 29 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,131 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe87c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,134 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,136 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 30 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,137 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8fd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,140 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,142 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 31 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,143 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8820>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,148 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,149 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 32 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,150 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe87c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,167 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,169 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 33 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,170 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8880>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,174 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,175 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 34 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,177 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe96c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,181 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,183 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 35 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,185 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9900>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,189 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,191 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 36 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,193 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8880>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,199 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,201 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 37 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,202 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f520>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,206 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,208 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 38 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,209 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe86d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,212 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,214 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 39 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,216 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9c60>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,219 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,222 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 40 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,223 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f520>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,244 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,245 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 41 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,246 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8d60>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,252 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:41:17,254 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 42 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,255 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8670>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,259 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,261 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 43 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,263 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8430>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,266 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,267 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 44 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,268 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8d60>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,276 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:41:17,279 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 45 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,280 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9cc0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,285 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,287 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 46 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,288 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9f30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,292 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,293 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 47 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,294 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea1d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,298 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,300 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 48 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,301 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9cc0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,318 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,319 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 49 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,321 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724fc70>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,324 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,325 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 50 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,327 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f4c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,330 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,332 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 51 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,333 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea650>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,337 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,338 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 52 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,340 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724fc70>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,345 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,347 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 53 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,349 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8070>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,351 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,353 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 54 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,355 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea500>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,358 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,360 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 55 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,361 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea260>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,365 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,367 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 56 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,368 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8070>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,385 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,386 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 57 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,388 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe95a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,391 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,392 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 58 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,394 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8040>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,397 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,399 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 59 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,399 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8160>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,403 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,404 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 60 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,405 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe95a0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,411 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,412 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 61 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,413 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8ac0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,416 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,418 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 62 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,419 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9bd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,423 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,425 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 63 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,426 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f580>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,429 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,431 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 64 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,433 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8ac0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,448 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,450 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 65 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,451 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe85b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,453 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:41:17,455 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 66 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,457 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe82e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,466 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.008s]
2025-03-01 20:41:17,468 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 67 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,470 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8400>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,476 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,478 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 68 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,480 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe85b0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,486 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,488 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 69 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,490 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe95a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,494 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,495 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 70 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,497 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe9ed0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,501 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:41:17,503 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 71 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,504 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea170>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:17,509 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:41:17,511 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 72 times in a row, putting on 30 second timeout
2025-03-01 20:41:17,512 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe95a0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:17,526 INFO     16 Indexing doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(0-12), chunks(36), elapsed: 0.74
2025-03-01 20:41:17,563 INFO     16 set_progress(50a38bb2f69a11ef85610242ac120006), progress: 1.0, progress_msg: 20:41:17 Page(1~13): Done (0.77s)
2025-03-01 20:41:17,584 INFO     16 Chunk doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(0-12), chunks(36), token(4191), elapsed:0.77
2025-03-01 20:41:17,586 INFO     16 handle_task done for task {"id": "50a38bb2f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811121, "task_type": ""}
2025-03-01 20:41:17,647 INFO     16 handle_task begin for task {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}
2025-03-01 20:41:17,987 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:41:17,994 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.003s]
2025-03-01 20:41:18,012 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 73 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,017 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f070>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:18,022 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:41:18,024 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 74 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,027 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe95a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:18,033 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:41:18,035 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 75 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,037 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea320>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:18,041 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:41:18,043 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 76 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,048 ERROR    16 ESConnection.indexExist got exception
Traceback (most recent call last):
  File "/ragflow/rag/utils/es_conn.py", line 120, in indexExist
    return s.exists()
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch_dsl/index.py", line 413, in exists
    return self._get_connection(using).indices.exists(index=self._name, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/utils.py", line 446, in wrapped
    return api(*args, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/indices.py", line 1121, in exists
    return self.perform_request(  # type: ignore[return-value]
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 389, in perform_request
    return self._client.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd97724f070>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:18,113 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:41:18,114 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 77 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,116 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8040>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:18,119 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.001s]
2025-03-01 20:41:18,120 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 78 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,122 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fea8c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:18,125 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.001s]
2025-03-01 20:41:18,127 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 79 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,128 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8160>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:41:18,132 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:41:18,134 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 80 times in a row, putting on 30 second timeout
2025-03-01 20:41:18,136 ERROR    16 ESConnection.createIndex error ragflow_ca473450f67211efae920242ac120006
Traceback (most recent call last):
  File "/ragflow/rag/utils/es_conn.py", line 99, in createIdx
    return IndicesClient(self.es).create(index=indexName,
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/utils.py", line 446, in wrapped
    return api(*args, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/indices.py", line 509, in create
    return self.perform_request(  # type: ignore[return-value]
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 389, in perform_request
    return self._client.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd976fe8040>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:41:18,210 INFO     16 From minio(0.07247320100213983) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 20:41:18,492 INFO     16 TextRecognizer det uses CPU
2025-03-01 20:41:18,675 INFO     16 TextRecognizer rec uses CPU
2025-03-01 20:41:19,870 INFO     16 Recognizer layout uses CPU
2025-03-01 20:41:19,971 INFO     16 Recognizer tsr uses CPU
2025-03-01 20:41:20,024 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: None, progress_msg: 20:41:20 Page(13~25): OCR started
2025-03-01 20:41:53,448 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:41:53.386+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:41:56,943 WARNING  16 Miss outlines
2025-03-01 20:42:04,469 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.3, progress_msg: 
2025-03-01 20:42:08,659 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.6, progress_msg: 
2025-03-01 20:42:08,681 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: None, progress_msg: 20:42:08 Page(13~25): OCR finished (48.70s)
2025-03-01 20:42:08,691 INFO     16 OCR(12~24): 48.71s
2025-03-01 20:43:19,144 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:42:23.581+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:44:48,030 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:44:26.731+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:45:38,053 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:45:26.858+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:46:08,493 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:46:08.146+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:46:39,471 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:46:38.908+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:47:16,436 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:47:15.821+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 5, "done": 2, "failed": 6, "current": {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}}
2025-03-01 20:47:29,459 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.63, progress_msg: 20:47:29 Page(13~25): Layout analysis (320.58s)
2025-03-01 20:47:30,989 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.65, progress_msg: 20:47:30 Page(13~25): Table analysis (1.48s)
2025-03-01 20:47:31,017 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.67, progress_msg: 20:47:31 Page(13~25): Text merged (0.00s)
2025-03-01 20:47:32,597 INFO     16 layouts cost: 372.6355075549982s
2025-03-01 20:47:35,786 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 2.9674851880008646
2025-03-01 20:47:35,789 INFO     16 Chunking(377.70884562500214) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 20:47:37,121 INFO     16 MINIO PUT(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf):1.1695727419937612
2025-03-01 20:47:37,123 INFO     16 Build document 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf: 379.04s
2025-03-01 20:47:37,131 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: None, progress_msg: 20:47:37 Page(13~25): Generate 54 chunks
2025-03-01 20:47:38,085 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.7037037037037036, progress_msg: 
2025-03-01 20:47:38,609 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.762962962962963, progress_msg: 
2025-03-01 20:47:39,110 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.8222222222222222, progress_msg: 
2025-03-01 20:47:39,515 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.8814814814814814, progress_msg: 
2025-03-01 20:47:39,545 INFO     16 Embedding chunks (2.40s)
2025-03-01 20:47:39,553 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: None, progress_msg: 20:47:39 Page(13~25): Embedding chunks (2.40s)
2025-03-01 20:47:39,586 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,410 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.821s]
2025-03-01 20:47:40,412 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has been marked alive after a successful request
2025-03-01 20:47:40,453 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 0.8018518518518519, progress_msg: 
2025-03-01 20:47:40,477 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,515 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.036s]
2025-03-01 20:47:40,534 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,600 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.064s]
2025-03-01 20:47:40,622 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,697 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.074s]
2025-03-01 20:47:40,712 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,747 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.034s]
2025-03-01 20:47:40,762 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,803 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.039s]
2025-03-01 20:47:40,816 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,908 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.090s]
2025-03-01 20:47:40,922 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:40,967 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.043s]
2025-03-01 20:47:40,984 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,039 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.054s]
2025-03-01 20:47:41,053 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,131 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.076s]
2025-03-01 20:47:41,147 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,203 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.055s]
2025-03-01 20:47:41,220 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,247 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.025s]
2025-03-01 20:47:41,263 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,295 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.031s]
2025-03-01 20:47:41,306 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,330 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:200 duration:0.022s]
2025-03-01 20:47:41,339 INFO     16 Indexing doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(12-24), chunks(54), elapsed: 1.77
2025-03-01 20:47:41,368 INFO     16 set_progress(50a3eb8ef69a11ef85610242ac120006), progress: 1.0, progress_msg: 20:47:41 Page(13~25): Done (1.80s)
2025-03-01 20:47:41,387 INFO     16 Chunk doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(12-24), chunks(54), token(6355), elapsed:1.80
2025-03-01 20:47:41,390 INFO     16 handle_task done for task {"id": "50a3eb8ef69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811122, "task_type": ""}
2025-03-01 20:47:41,428 INFO     16 handle_task begin for task {"id": "50a3edf0f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811123, "task_type": ""}
2025-03-01 20:47:41,721 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:47:41,752 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:200 duration:0.029s]
2025-03-01 20:47:41,803 INFO     16 From minio(0.04902887400021427) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 20:47:42,040 INFO     16 TextRecognizer det uses CPU
2025-03-01 20:47:42,255 INFO     16 TextRecognizer rec uses CPU
2025-03-01 20:47:43,355 INFO     16 Recognizer layout uses CPU
2025-03-01 20:47:43,531 INFO     16 Recognizer tsr uses CPU
2025-03-01 20:47:43,652 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: None, progress_msg: 20:47:43 Page(25~37): OCR started
2025-03-01 20:47:47,161 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:47:47.142+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 4, "done": 3, "failed": 6, "current": {"id": "50a3edf0f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811123, "task_type": ""}}
2025-03-01 20:47:47,817 WARNING  16 Miss outlines
2025-03-01 20:47:50,237 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.3, progress_msg: 
2025-03-01 20:47:52,350 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.6, progress_msg: 
2025-03-01 20:47:52,368 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: None, progress_msg: 20:47:52 Page(25~37): OCR finished (8.72s)
2025-03-01 20:47:52,379 INFO     16 OCR(24~36): 8.73s
2025-03-01 20:48:21,340 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:48:17.257+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 4, "done": 3, "failed": 6, "current": {"id": "50a3edf0f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811123, "task_type": ""}}
2025-03-01 20:48:56,312 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:48:54.880+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 4, "done": 3, "failed": 6, "current": {"id": "50a3edf0f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811123, "task_type": ""}}
2025-03-01 20:49:26,553 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:49:26.516+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 4, "done": 3, "failed": 6, "current": {"id": "50a3edf0f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811123, "task_type": ""}}
2025-03-01 20:49:34,743 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.63, progress_msg: 20:49:34 Page(25~37): Layout analysis (102.34s)
2025-03-01 20:49:34,770 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.65, progress_msg: 20:49:34 Page(25~37): Table analysis (0.00s)
2025-03-01 20:49:34,793 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.67, progress_msg: 20:49:34 Page(25~37): Text merged (0.00s)
2025-03-01 20:49:36,031 INFO     16 layouts cost: 112.38925729900075s
2025-03-01 20:49:37,575 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 1.3106778299988946
2025-03-01 20:49:37,577 INFO     16 Chunking(115.82807906599919) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 20:49:42,480 INFO     16 MINIO PUT(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf):4.754589260999637
2025-03-01 20:49:42,531 INFO     16 Build document 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf: 120.78s
2025-03-01 20:49:42,551 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: None, progress_msg: 20:49:42 Page(25~37): Generate 49 chunks
2025-03-01 20:49:44,706 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.7040816326530612, progress_msg: 
2025-03-01 20:49:45,536 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.7693877551020408, progress_msg: 
2025-03-01 20:49:46,251 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.8346938775510204, progress_msg: 
2025-03-01 20:49:46,531 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.8999999999999999, progress_msg: 
2025-03-01 20:49:46,626 INFO     16 Embedding chunks (4.01s)
2025-03-01 20:49:46,634 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: None, progress_msg: 20:49:46 Page(25~37): Embedding chunks (4.01s)
2025-03-01 20:49:46,699 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,720 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.017s]
2025-03-01 20:49:46,723 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-03-01 20:49:46,725 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda1c04e950>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,752 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,756 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,757 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-03-01 20:49:46,759 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248244c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,760 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,763 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,765 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-03-01 20:49:46,766 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824100>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,767 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,770 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,772 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-03-01 20:49:46,773 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda1c04e950>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:46,781 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,785 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,786 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-03-01 20:49:46,787 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248247f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,789 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,795 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.005s]
2025-03-01 20:49:46,797 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,798 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824730>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,800 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,804 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,806 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,807 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824ac0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,810 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,814 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:46,816 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,817 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248247f0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:46,828 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 0.8020408163265307, progress_msg: 
2025-03-01 20:49:46,859 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,864 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,865 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,867 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda23ce7fd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,871 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,880 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.008s]
2025-03-01 20:49:46,882 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,883 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda1c04e6e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,884 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,888 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,889 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,890 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824fd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,891 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,894 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,895 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,897 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda23ce7fd0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:46,902 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,905 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,906 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 13 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,908 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825450>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,909 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,913 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,914 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 14 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,916 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824e50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,918 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,921 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,923 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 15 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,924 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824df0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,925 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,929 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,930 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 16 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,931 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825450>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:46,953 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,956 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,957 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 17 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,958 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824220>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,960 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,963 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,964 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 18 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,966 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824310>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,967 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,970 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:46,971 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 19 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,972 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824280>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:46,973 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,977 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:46,978 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 20 times in a row, putting on 30 second timeout
2025-03-01 20:49:46,979 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824220>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:46,983 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:46,986 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,053 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 21 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,054 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825840>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,056 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,059 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,061 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 22 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,062 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda1c04f100>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,063 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,068 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:47,069 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 23 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,070 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda23ce78b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,071 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,074 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,075 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 24 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,076 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825840>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,091 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,097 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:49:47,100 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 25 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,101 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824460>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,104 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,109 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,110 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 26 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,112 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824550>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,113 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,118 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:47,120 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 27 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,121 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824820>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,123 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,127 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:47,129 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 28 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,130 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824460>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,134 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,138 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,139 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 29 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,140 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824d00>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,141 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,144 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,145 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 30 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,147 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824d30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,149 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,153 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:47,154 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 31 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,155 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824e20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,156 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,159 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,161 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 32 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,162 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824d00>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,306 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,310 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:47,312 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 33 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,313 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248250c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,315 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,317 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,319 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 34 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,320 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825b10>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,322 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,325 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,327 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 35 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,328 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825d50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,330 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,333 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,335 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 36 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,336 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248250c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,340 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,343 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,344 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 37 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,345 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248250f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,347 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,350 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,352 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 38 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,353 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824bb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,354 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,358 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,359 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 39 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,360 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248249d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,361 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,365 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,366 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 40 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,368 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248250f0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,383 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,386 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,388 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 41 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,389 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824b80>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,390 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,393 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,395 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 42 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,396 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248240d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,398 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,401 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,402 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 43 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,404 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248243d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,405 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,408 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,410 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 44 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,411 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824b80>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,415 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,418 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,419 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 45 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,420 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826110>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,422 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,425 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,426 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 46 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,427 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826380>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,429 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,431 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,433 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 47 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,434 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826620>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,436 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,438 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,439 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 48 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,441 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826110>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,457 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,460 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,462 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 49 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,463 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826bf0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,465 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,467 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,469 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 50 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,470 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826c20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,472 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,475 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,477 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 51 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,479 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824460>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,481 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,483 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,485 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 52 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,486 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826bf0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,490 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,493 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,495 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 53 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,496 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248262f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,498 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,501 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,502 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 54 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,504 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824370>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,505 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,509 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,510 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 55 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,511 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24825000>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,513 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,517 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,518 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 56 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,519 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248262f0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,537 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,540 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,542 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 57 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,543 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824430>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,544 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,547 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,549 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 58 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,550 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824220>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,552 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,555 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,557 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 59 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,559 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826080>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,560 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,564 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,565 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 60 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,567 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824430>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,572 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,576 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,577 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 61 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,579 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824c40>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,580 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,584 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,585 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 62 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,586 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248250f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,589 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,592 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,593 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 63 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,595 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826e90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,596 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,599 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,601 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 64 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,602 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824c40>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,696 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,698 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 65 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,698 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248252a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,701 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,703 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 66 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,704 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824490>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,708 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,710 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 67 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,711 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824430>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,715 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,716 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 68 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,717 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248252a0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,731 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.010s]
2025-03-01 20:49:47,733 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 69 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,734 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824640>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,736 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:49:47,739 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,740 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 70 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,741 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824370>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,744 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,745 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 71 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,747 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248262f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,750 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,751 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 72 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,753 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824640>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,773 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,774 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 73 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,775 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826830>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,778 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,779 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 74 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,781 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826b90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,784 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,785 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 75 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,786 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826bc0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,790 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,791 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 76 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,792 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826830>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,798 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,800 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 77 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,801 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248271c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,805 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,807 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 78 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,809 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24827040>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,812 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,814 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 79 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,815 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826da0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,818 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,820 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 80 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,821 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248271c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,837 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,839 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 81 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,840 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826830>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,843 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,845 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 82 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,846 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248262c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,851 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,852 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 83 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,854 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248265c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,857 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,859 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 84 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,860 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826830>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,866 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,868 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 85 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,869 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824400>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,872 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,874 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 86 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,875 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826aa0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,878 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,880 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 87 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,881 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824820>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,884 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,885 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 88 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,886 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824400>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,916 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.012s]
2025-03-01 20:49:47,918 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 89 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,919 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248252a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,922 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,923 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 90 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,925 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248274f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,929 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,931 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 91 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,933 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24827820>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,937 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,939 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 92 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,941 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda248252a0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,946 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,948 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 93 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,949 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824850>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,952 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,954 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 94 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,955 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824a30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,959 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,960 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 95 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,961 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826770>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,965 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,966 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 96 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,967 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824850>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:47,985 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,986 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 97 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,988 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824370>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,991 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:47,993 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 98 times in a row, putting on 30 second timeout
2025-03-01 20:49:47,994 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826860>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:47,997 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:47,998 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 99 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,000 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824340>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,003 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:48,005 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 100 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,007 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24824370>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:48,010 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:48,012 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 101 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,013 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826f80>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,016 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:49:48,018 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 102 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,019 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826d40>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,023 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:49:48,025 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 103 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,026 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24827160>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,031 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:49:48,032 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 104 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,033 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826f80>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:48,044 INFO     16 Indexing doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(24-36), chunks(49), elapsed: 1.39
2025-03-01 20:49:48,109 INFO     16 set_progress(50a3edf0f69a11ef85610242ac120006), progress: 1.0, progress_msg: 20:49:48 Page(25~37): Done (1.42s)
2025-03-01 20:49:48,138 INFO     16 Chunk doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(24-36), chunks(49), token(4873), elapsed:1.42
2025-03-01 20:49:48,141 INFO     16 handle_task done for task {"id": "50a3edf0f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811123, "task_type": ""}
2025-03-01 20:49:48,186 INFO     16 handle_task begin for task {"id": "50a3eea4f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811124, "task_type": ""}
2025-03-01 20:49:48,504 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,505 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 105 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,506 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826ce0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,510 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,511 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 106 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,512 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24827340>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,516 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,517 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 107 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,519 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826350>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,522 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,523 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 108 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,525 ERROR    16 ESConnection.indexExist got exception
Traceback (most recent call last):
  File "/ragflow/rag/utils/es_conn.py", line 120, in indexExist
    return s.exists()
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch_dsl/index.py", line 413, in exists
    return self._get_connection(using).indices.exists(index=self._name, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/utils.py", line 446, in wrapped
    return api(*args, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/indices.py", line 1121, in exists
    return self.perform_request(  # type: ignore[return-value]
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 389, in perform_request
    return self._client.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826ce0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:48,546 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,548 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 109 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,549 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826830>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,552 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,553 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 110 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,555 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24827fd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,558 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,560 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 111 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,561 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24827460>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:49:48,565 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:49:48,566 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 112 times in a row, putting on 30 second timeout
2025-03-01 20:49:48,568 ERROR    16 ESConnection.createIndex error ragflow_ca473450f67211efae920242ac120006
Traceback (most recent call last):
  File "/ragflow/rag/utils/es_conn.py", line 99, in createIdx
    return IndicesClient(self.es).create(index=indexName,
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/utils.py", line 446, in wrapped
    return api(*args, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/indices.py", line 509, in create
    return self.perform_request(  # type: ignore[return-value]
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 389, in perform_request
    return self._client.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826830>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:49:48,662 INFO     16 From minio(0.09143781799866701) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 20:49:49,106 INFO     16 TextRecognizer det uses CPU
2025-03-01 20:49:49,566 INFO     16 TextRecognizer rec uses CPU
2025-03-01 20:49:51,154 INFO     16 Recognizer layout uses CPU
2025-03-01 20:49:51,425 INFO     16 Recognizer tsr uses CPU
2025-03-01 20:49:51,489 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: None, progress_msg: 20:49:51 Page(37~49): OCR started
2025-03-01 20:49:56,606 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:49:56.593+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 3, "done": 4, "failed": 6, "current": {"id": "50a3eea4f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811124, "task_type": ""}}
2025-03-01 20:49:56,955 WARNING  16 Miss outlines
2025-03-01 20:50:02,243 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.3, progress_msg: 
2025-03-01 20:50:07,143 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.6, progress_msg: 
2025-03-01 20:50:07,162 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: None, progress_msg: 20:50:07 Page(37~49): OCR finished (15.68s)
2025-03-01 20:50:07,174 INFO     16 OCR(36~48): 15.70s
2025-03-01 20:50:26,676 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:50:26.662+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 3, "done": 4, "failed": 6, "current": {"id": "50a3eea4f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811124, "task_type": ""}}
2025-03-01 20:50:36,618 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.63, progress_msg: 20:50:36 Page(37~49): Layout analysis (29.43s)
2025-03-01 20:50:36,899 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.65, progress_msg: 20:50:36 Page(37~49): Table analysis (0.25s)
2025-03-01 20:50:36,923 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.67, progress_msg: 20:50:36 Page(37~49): Text merged (0.00s)
2025-03-01 20:50:38,816 INFO     16 layouts cost: 47.33468963899941s
2025-03-01 20:50:46,917 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 8.017950126999494
2025-03-01 20:50:46,926 INFO     16 Chunking(58.356882698000845) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 20:50:48,258 INFO     16 MINIO PUT(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf):1.131982107006479
2025-03-01 20:50:48,264 INFO     16 Build document 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf: 59.69s
2025-03-01 20:50:48,388 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: None, progress_msg: 20:50:48 Page(37~49): Generate 40 chunks
2025-03-01 20:50:49,485 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.705, progress_msg: 
2025-03-01 20:50:50,066 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.7849999999999999, progress_msg: 
2025-03-01 20:50:50,486 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.865, progress_msg: 
2025-03-01 20:50:50,523 INFO     16 Embedding chunks (2.11s)
2025-03-01 20:50:50,529 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: None, progress_msg: 20:50:50 Page(37~49): Embedding chunks (2.11s)
2025-03-01 20:50:50,556 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,562 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:50:50,564 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 113 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,565 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a740>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,574 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,578 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:50,580 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 114 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,581 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3ad70>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,583 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,587 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,588 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 115 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,589 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a440>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,591 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,594 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,595 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 116 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,597 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a740>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,601 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,605 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,607 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 117 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,608 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b4c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,610 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,615 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:50,616 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 118 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,618 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b730>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,619 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,624 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,625 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 119 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,626 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3ba00>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,629 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,632 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,634 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 120 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,635 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b4c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,643 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 0.8025, progress_msg: 
2025-03-01 20:50:50,664 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,667 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:50,669 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 121 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,670 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bb20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,672 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,677 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:50:50,679 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 122 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,680 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bd30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,682 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,688 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:50:50,690 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 123 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,691 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b7f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,693 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,696 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,697 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 124 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,699 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bb20>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,703 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,707 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,708 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 125 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,710 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3be20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,712 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,715 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,716 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 126 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,718 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b370>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,719 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,723 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,724 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 127 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,726 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3afb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,727 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,731 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,732 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 128 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,734 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3be20>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,746 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,750 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,752 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 129 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,754 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3ae90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,761 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,764 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,766 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 130 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,768 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fda24826dd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,770 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,775 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:50,777 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 131 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,778 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a981f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,781 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,786 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,787 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 132 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,789 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3ae90>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,793 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,798 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:50,799 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 133 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,800 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98820>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,802 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,806 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,808 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 134 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,809 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98a90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,812 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,816 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:50,817 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 135 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,819 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bcd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,821 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,824 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,825 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 136 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,826 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98820>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,849 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,853 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,854 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 137 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,855 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3ac20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,857 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,860 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,862 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 138 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,863 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3afb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,865 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,868 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,870 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 139 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,871 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bd90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,873 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,876 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,878 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 140 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,879 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3ac20>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,883 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,887 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,889 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 141 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,890 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b310>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,892 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,896 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,897 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 142 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,899 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b9a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,901 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,904 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,906 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 143 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,907 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b2b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,908 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,911 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,913 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 144 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,914 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b310>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,927 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,930 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,931 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 145 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,933 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98730>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,934 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,939 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:50:50,940 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 146 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,942 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98160>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,943 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,946 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,948 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 147 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,949 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a980a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,951 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,954 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,956 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 148 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,957 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98730>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:50,962 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,967 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:50,968 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 149 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,970 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a99360>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,971 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,974 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,975 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 150 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,977 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bbb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,979 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,982 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,984 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 151 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,985 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bb80>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:50,987 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:50,990 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:50,991 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 152 times in a row, putting on 30 second timeout
2025-03-01 20:50:50,993 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a99360>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,005 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,008 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,010 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 153 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,011 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a8f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,013 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,016 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,017 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 154 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,018 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3be20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,020 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,023 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,024 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 155 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,025 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a380>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,027 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,030 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,031 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 156 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,033 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a8f0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,037 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,041 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,042 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 157 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,044 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a5f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,046 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,048 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,050 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 158 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,052 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b610>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,053 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,056 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,057 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 159 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,058 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98fa0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,060 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,065 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.004s]
2025-03-01 20:50:51,066 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 160 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,068 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a5f0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,082 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,090 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.006s]
2025-03-01 20:50:51,091 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 161 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,093 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98e80>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,094 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,097 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,098 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 162 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,099 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98130>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,101 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,103 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,104 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 163 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,106 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a99600>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,108 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,111 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,112 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 164 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,113 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98e80>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,117 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,121 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,122 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 165 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,126 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b400>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,128 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,131 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,133 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 166 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,134 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3a620>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,136 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,138 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,140 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 167 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,141 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bc40>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,143 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,145 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,146 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 168 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,147 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b400>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,162 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,165 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,166 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 169 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,168 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b8b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,169 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,173 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.003s]
2025-03-01 20:50:51,175 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 170 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,176 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bf10>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,178 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,181 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,183 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 171 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,184 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98e20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,186 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,189 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,190 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 172 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,192 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b8b0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,197 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,201 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,202 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 173 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,204 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a999c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,205 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,208 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,210 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 174 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,211 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a99c30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,212 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,216 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,217 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 175 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,219 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a99ed0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,221 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,224 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,225 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 176 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,227 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a999c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,241 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,244 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,246 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 177 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,247 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bb50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,248 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,252 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,253 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 178 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,254 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b2b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,256 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,258 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,260 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 179 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,261 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3be20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,263 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,266 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,267 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 180 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,268 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bb50>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,272 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,276 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,277 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 181 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,279 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b460>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,281 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,284 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,285 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 182 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,287 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b970>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,289 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,291 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,293 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 183 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,294 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b340>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,296 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,299 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,300 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 184 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,302 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b460>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,315 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,319 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,320 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 185 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,321 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a9a560>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,323 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,326 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,327 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 186 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,328 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a9a1a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,330 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,333 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,334 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 187 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,336 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a9a020>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,337 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,340 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,341 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 188 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,342 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a9a560>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,347 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,350 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,351 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 189 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,352 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98fa0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,354 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,357 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,359 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 190 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,361 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a980a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,376 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,381 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.002s]
2025-03-01 20:50:51,382 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 191 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,384 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bac0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,386 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,389 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006/_bulk?refresh=false&timeout=60s [status:N/A duration:0.001s]
2025-03-01 20:50:51,393 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 192 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,394 WARNING  16 ESConnection.insert got exception: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977a98fa0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,405 INFO     16 Indexing doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(36-48), chunks(40), elapsed: 0.86
2025-03-01 20:50:51,437 INFO     16 set_progress(50a3eea4f69a11ef85610242ac120006), progress: 1.0, progress_msg: 20:50:51 Page(37~49): Done (0.89s)
2025-03-01 20:50:51,458 INFO     16 Chunk doc(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf), page(36-48), chunks(40), token(5947), elapsed:0.89
2025-03-01 20:50:51,460 INFO     16 handle_task done for task {"id": "50a3eea4f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811124, "task_type": ""}
2025-03-01 20:50:51,496 INFO     16 handle_task begin for task {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}
2025-03-01 20:50:51,783 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,786 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.001s]
2025-03-01 20:50:51,788 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 193 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,789 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b310>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,791 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,794 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.001s]
2025-03-01 20:50:51,795 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 194 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,797 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b010>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,799 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,802 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:50:51,803 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 195 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,805 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3bf70>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,807 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,810 INFO     16 HEAD http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:50:51,811 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 196 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,813 ERROR    16 ESConnection.indexExist got exception
Traceback (most recent call last):
  File "/ragflow/rag/utils/es_conn.py", line 120, in indexExist
    return s.exists()
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch_dsl/index.py", line 413, in exists
    return self._get_connection(using).indices.exists(index=self._name, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/utils.py", line 446, in wrapped
    return api(*args, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/indices.py", line 1121, in exists
    return self.perform_request(  # type: ignore[return-value]
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 389, in perform_request
    return self._client.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b310>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,824 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,827 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:50:51,829 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 197 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,830 WARNING  16 Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b5e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,832 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,835 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.001s]
2025-03-01 20:50:51,837 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 198 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,839 WARNING  16 Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b700>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,841 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,843 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.001s]
2025-03-01 20:50:51,845 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 199 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,846 WARNING  16 Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3abc0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-03-01 20:50:51,848 INFO     16 Resurrected node <Urllib3HttpNode(http://es01:9200)> (force=False)
2025-03-01 20:50:51,850 INFO     16 PUT http://es01:9200/ragflow_ca473450f67211efae920242ac120006 [status:N/A duration:0.002s]
2025-03-01 20:50:51,852 WARNING  16 Node <Urllib3HttpNode(http://es01:9200)> has failed for 200 times in a row, putting on 30 second timeout
2025-03-01 20:50:51,853 ERROR    16 ESConnection.createIndex error ragflow_ca473450f67211efae920242ac120006
Traceback (most recent call last):
  File "/ragflow/rag/utils/es_conn.py", line 99, in createIdx
    return IndicesClient(self.es).create(index=indexName,
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/utils.py", line 446, in wrapped
    return api(*args, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/indices.py", line 509, in create
    return self.perform_request(  # type: ignore[return-value]
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 389, in perform_request
    return self._client.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 328, in perform_request
    meta, raw_data = node.perform_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fd977d3b5e0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-03-01 20:50:51,915 INFO     16 From minio(0.060715313000400783) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf
2025-03-01 20:50:52,143 INFO     16 TextRecognizer det uses CPU
2025-03-01 20:50:52,369 INFO     16 TextRecognizer rec uses CPU
2025-03-01 20:50:53,166 INFO     16 Recognizer layout uses CPU
2025-03-01 20:50:53,275 INFO     16 Recognizer tsr uses CPU
2025-03-01 20:50:53,347 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: None, progress_msg: 20:50:53 Page(49~61): OCR started
2025-03-01 20:50:56,770 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:50:56.720+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:50:57,119 WARNING  16 Miss outlines
2025-03-01 20:51:01,847 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: 0.3, progress_msg: 
2025-03-01 20:51:07,659 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: 0.6, progress_msg: 
2025-03-01 20:51:07,827 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: None, progress_msg: 20:51:07 Page(49~61): OCR finished (14.48s)
2025-03-01 20:51:07,851 INFO     16 OCR(48~60): 14.51s
2025-03-01 20:51:26,858 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:51:26.847+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:51:33,545 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: 0.63, progress_msg: 20:51:33 Page(49~61): Layout analysis (25.65s)
2025-03-01 20:51:33,604 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: 0.65, progress_msg: 20:51:33 Page(49~61): Table analysis (0.00s)
2025-03-01 20:51:33,639 INFO     16 set_progress(50a3ef30f69a11ef85610242ac120006), progress: 0.67, progress_msg: 20:51:33 Page(49~61): Text merged (0.00s)
2025-03-01 20:51:38,521 INFO     16 layouts cost: 45.18032000700259s
2025-03-01 20:52:31,142 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:51:56.946+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:53:31,585 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:53:23.925+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:53:48,064 INFO     16 naive_merge(20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf): 129.17675613199754
2025-03-01 20:53:48,084 INFO     16 Chunking(176.23233516200344) 20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf/20230314-智能家居行业：2025中国高端智能家居生活场景白皮书.pdf done
2025-03-01 20:53:58,398 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cfac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006
2025-03-01 20:54:09,375 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5570>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006
2025-03-01 20:54:17,912 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:54:08.940+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:54:26,275 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5780>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006
2025-03-01 20:54:39,163 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5750>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006
2025-03-01 20:54:51,878 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:54:50.140+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:54:53,257 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5a80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006
2025-03-01 20:55:05,575 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/4dc7ae38e5a9c9c1:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5690>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 440, in _execute
    return self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006 (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5690>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 20:55:17,780 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6290>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 20:55:26,569 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:55:22.087+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:55:34,751 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a3b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 20:55:47,567 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cf190>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 20:56:03,763 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:56:00.160+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 20:56:08,722 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5480>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 20:56:27,644 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5540>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 20:56:39,970 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T20:56:33.887+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:18:25,793 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/4dc7ae38e5a9c9c1:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5b70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5b70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:18:26,894 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5270>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:27,304 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6440>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:28,110 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f65f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:29,716 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f67a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:32,926 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6950>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:32,932 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/4dc7ae38e5a9c9c1:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6b00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:18:34,088 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f71c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:34,493 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7370>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:35,299 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7520>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:36,903 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f76d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:40,127 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:40,133 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/28d5a98fbcb73476:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd977a99c90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977a99c90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:18:41,138 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f55a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:41,542 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6710>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:42,346 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6bc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:43,951 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6800>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:47,159 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f66b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:47,162 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/28d5a98fbcb73476:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5330>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5330>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:18:48,168 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6140>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:48,573 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5cf0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:49,377 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5420>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:50,819 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:18:50.804+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:18:50,982 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5c00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:54,190 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f59f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:54,197 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/28d5a98fbcb73476:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:18:55,242 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832502b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:55,775 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250460>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:56,579 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a2560>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:18:58,185 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda6092ba90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:01,394 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977a99f60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:01,407 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c56063baf95a6541:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f55d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f55d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:02,416 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f4610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:02,820 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5a20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:03,625 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f61d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:05,229 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5f30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:08,436 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5720>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:08,440 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c56063baf95a6541:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f63e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f63e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:09,447 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6a40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:09,851 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6ad0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:10,656 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5990>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:12,261 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6c20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:15,468 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7340>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:15,472 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c56063baf95a6541:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7850>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7850>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:16,510 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f77c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:16,913 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:17,718 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6080>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:19,323 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5510>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:20,866 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:19:20.861+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:19:22,558 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5bd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:22,561 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/acec3402a4089661:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5450>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5450>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:23,567 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5b70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:23,971 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5f00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:24,775 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7520>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:26,386 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f72b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:29,593 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7100>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:29,596 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/acec3402a4089661:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6dd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6dd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:30,602 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250910>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:31,005 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250ac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:31,810 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250c70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:33,416 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f60b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:36,622 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6230>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:36,626 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/acec3402a4089661:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7370>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7370>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:37,693 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6200>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:38,098 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5150>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:38,904 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5cf0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:40,509 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5d20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:43,716 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f68f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:43,719 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/3e7e8eb3b2312c03:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5720>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5720>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:44,725 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a3b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:45,129 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a2cb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:45,933 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977a99f00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:47,538 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250e20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:50,745 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250fd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:50,749 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/3e7e8eb3b2312c03:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832511b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832511b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:50,909 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:19:50.899+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:19:51,755 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5bd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:52,158 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:52,962 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5a20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:54,567 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5de0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:57,774 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f53c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:57,777 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/3e7e8eb3b2312c03:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6da0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6da0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:19:58,793 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250c40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:19:59,198 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251480>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:00,002 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251630>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:01,632 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832517e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:04,838 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251990>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:04,868 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/babc1e3a7213fb65:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983251b40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251b40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:05,880 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832522c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:06,285 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252470>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:07,088 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6170>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:08,694 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f60e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:11,901 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f4610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:11,904 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/babc1e3a7213fb65:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f62c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f62c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:12,935 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5630>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:13,339 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5870>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:14,143 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f68f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:15,773 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5d50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:18,980 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7460>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:18,983 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/babc1e3a7213fb65:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983250c70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250c70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:20,007 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251570>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:20,411 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:20,944 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:20:20.943+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:20:21,215 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252650>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:22,820 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252740>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:26,027 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252ad0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:26,031 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/fd159e50b3a4184f:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252c20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252c20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:27,037 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5180>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:27,441 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5570>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:28,255 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5de0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:29,860 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f75b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:33,067 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5db0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:33,070 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/fd159e50b3a4184f:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f59f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f59f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:34,079 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251780>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:34,482 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252dd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:35,287 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252f80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:36,893 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253130>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:40,101 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832532e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:40,106 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/fd159e50b3a4184f:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832534c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832534c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:41,125 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253ca0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:41,529 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253e50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:42,333 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f62c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:43,938 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f4610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:47,145 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5b40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:47,147 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e9da6d2d23a2bcea:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:48,153 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6d10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:48,557 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5570>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:49,361 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7970>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:50,966 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7af0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:50,967 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:20:50.965+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:20:54,172 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253ee0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:54,176 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e9da6d2d23a2bcea:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832530d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832530d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:20:55,189 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252e30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:55,620 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251600>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:56,425 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252c80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:20:58,031 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832780d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:01,237 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278280>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:01,246 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e9da6d2d23a2bcea:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278430>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278430>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:02,302 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f56c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:02,706 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5900>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:03,510 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6da0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:05,115 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7520>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:08,321 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6d10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:08,324 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e2fcff134218c5fe:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f53c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f53c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:09,329 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f4610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:09,757 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5ae0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:10,561 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278640>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:12,166 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:15,373 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832789a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:15,376 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e2fcff134218c5fe:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:16,382 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279360>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:16,787 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279510>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:17,591 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7100>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:19,196 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f61d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:21,002 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:21:20.975+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:21:22,403 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f59c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:22,406 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e2fcff134218c5fe:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f73d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f73d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:23,448 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6d10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:23,852 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5870>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:24,656 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5900>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:26,261 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f75b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:29,467 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:29,470 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e4d794da36bdf081:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253ee0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253ee0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:30,478 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832789d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:30,882 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278640>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:31,686 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832783a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:33,291 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832796f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:36,498 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832798a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:36,503 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e4d794da36bdf081:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983279a50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279a50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:37,509 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7250>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:37,914 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7040>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:38,718 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5180>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:40,323 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f71c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:43,530 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7a90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:43,534 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/e4d794da36bdf081:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5c00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5c00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:44,570 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7100>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:44,975 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832794e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:45,779 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279c90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:47,384 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279e40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:50,591 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279ff0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:50,595 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b788b76b8e3c9cac:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327a1a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a1a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:51,037 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:21:51.035+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:21:51,625 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a950>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:52,030 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ab30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:52,833 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5fc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:54,439 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5720>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:57,645 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5ae0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:57,649 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b788b76b8e3c9cac:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7130>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7130>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:21:58,654 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5d20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:59,057 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7220>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:21:59,861 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6230>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:01,466 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f56f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:04,673 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253e80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:04,676 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b788b76b8e3c9cac:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:05,699 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279e70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:06,104 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832794e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:06,908 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279ab0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:08,513 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ad10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:11,720 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327aec0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:11,725 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/989b39a1dc8177c2:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b070>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b070>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:12,757 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7040>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:13,161 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7af0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:13,964 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7250>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:15,569 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5a80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:18,776 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5ed0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:18,779 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/989b39a1dc8177c2:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6110>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6110>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:19,810 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5480>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:20,214 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b2b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:21,018 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b460>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:21,073 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:22:21.071+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:22:22,624 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:25,831 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a440>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:25,834 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/989b39a1dc8177c2:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327bac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327bac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:26,897 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a81c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:27,304 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8370>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:28,108 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b5b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:29,714 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ba00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:32,920 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:32,924 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/9b3eac2580341214:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b550>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b550>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:33,937 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ae60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:34,340 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b130>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:35,143 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ad70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:36,749 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327abc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:39,955 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279cf0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:39,959 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/9b3eac2580341214:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983279f30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:40,965 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a680>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:41,368 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a560>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:42,172 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a4a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:43,777 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278a60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:46,983 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832796c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:46,986 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/9b3eac2580341214:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983279930>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279930>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:48,007 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a020>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:48,411 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279d80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:49,216 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279570>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:50,820 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327aec0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:51,132 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:22:51.131+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:22:54,027 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ae60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:54,031 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/7dbb920ce212a168:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:22:55,037 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327bac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:55,441 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b580>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:56,245 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278580>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:22:57,850 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:01,057 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:01,060 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/7dbb920ce212a168:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832790f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832790f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:02,065 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278220>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:02,469 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832782b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:03,274 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977d3b1f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:04,879 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279b70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:08,085 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b8e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:08,088 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/7dbb920ce212a168:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:09,126 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b700>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:09,531 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b9a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:10,334 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b7c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:11,940 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279780>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:15,146 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279a50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:15,175 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/acc8d1ec396a3da1:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327ada0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ada0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:16,180 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:16,583 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279ab0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:17,386 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b2b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:18,992 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a17b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:21,191 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:23:21.165+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:23:22,198 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cd930>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:22,201 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/acc8d1ec396a3da1:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253460>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253460>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:23,233 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b040>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:23,636 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ae00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:24,440 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a260>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:26,045 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ba60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:29,252 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b580>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:29,255 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/acc8d1ec396a3da1:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:30,275 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252ef0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:30,679 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253f70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:31,484 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253130>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:33,089 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252b90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:36,295 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252ce0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:36,298 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/546a59ada1aacfda:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252e00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252e00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:37,304 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:37,708 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:38,521 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327baf0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:40,126 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b6a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:43,332 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278c70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:43,335 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/546a59ada1aacfda:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278cd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278cd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:44,340 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:44,743 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b4c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:45,547 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279c30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:47,152 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:50,360 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278850>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:50,364 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/546a59ada1aacfda:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832530a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832530a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:51,225 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:23:51.224+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:23:51,378 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832532e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:51,782 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252ef0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:52,587 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832538e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:54,191 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251840>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:57,423 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832525f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:57,426 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/a099a3a5a0aeb466:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252a10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252a10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:23:58,433 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:58,836 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832789a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:23:59,640 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278a00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:01,245 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:04,451 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ba30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:04,454 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/a099a3a5a0aeb466:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:05,460 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252fb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:05,863 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252740>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:06,667 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252590>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:08,272 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251990>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:11,479 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251b40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:11,482 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/a099a3a5a0aeb466:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983251900>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251900>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:12,503 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251ea0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:12,907 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251de0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:13,711 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:15,319 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278370>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:18,526 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ace0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:18,529 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b31ad333c8e7a4fb:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b7c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b7c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:19,537 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ba90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:19,941 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279720>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:20,745 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b0d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:21,259 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:24:21.258+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:24:22,350 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832794e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:25,557 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:25,560 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b31ad333c8e7a4fb:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832528f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832528f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:26,566 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250ca0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:26,970 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252fb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:27,774 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252a70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:29,379 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250e20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:32,586 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250fd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:32,589 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b31ad333c8e7a4fb:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832511b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832511b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:33,645 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278670>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:34,048 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279780>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:34,852 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b520>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:36,457 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b5e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:39,663 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278cd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:39,665 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b472d1be76272700:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278640>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278640>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:40,696 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251690>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:41,100 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251ed0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:41,906 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832505e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:43,511 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250ac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:46,718 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250940>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:46,721 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b472d1be76272700:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983250550>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250550>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:47,727 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f62c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:48,131 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6e30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:48,936 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251e10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:50,541 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832509a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:51,320 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:24:51.292+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:24:53,744 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250640>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:53,749 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b472d1be76272700:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983250820>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250820>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:24:54,803 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278700>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:55,206 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b6a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:56,009 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832789d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:24:57,614 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b280>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:00,820 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327bac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:00,823 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b52469867582b945:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327ae90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ae90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:01,829 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279a80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:02,233 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327abc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:03,037 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:04,642 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:07,849 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5f30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:07,852 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b52469867582b945:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7970>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7970>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:08,858 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:09,262 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:10,066 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b7f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:11,671 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250700>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:14,878 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250430>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:14,882 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b52469867582b945:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983251de0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251de0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:15,928 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832507c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:16,331 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5600>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:17,139 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5630>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:18,744 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5c90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:21,355 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:25:21.353+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:25:21,951 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5ab0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:21,954 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/576be490cd3dfac3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:22,961 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6740>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:23,366 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f66b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:24,169 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251480>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:25,774 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250880>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:28,981 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250460>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:28,984 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/576be490cd3dfac3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983250a00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250a00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:29,989 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279120>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:30,393 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832785b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:31,197 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279c30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:32,802 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278850>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:36,008 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ba90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:36,013 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/576be490cd3dfac3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278970>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278970>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:37,054 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7520>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:37,458 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7220>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:38,262 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5990>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:39,867 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f64a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:43,074 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6d70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:43,079 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/92d036df508f1742:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f74f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f74f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:44,085 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327add0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:44,489 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ace0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:45,294 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b700>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:46,900 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253fd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:50,106 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250e80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:50,110 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/92d036df508f1742:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983251690>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251690>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:51,115 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250550>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:51,385 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:25:51.383+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:25:51,518 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7a00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:52,322 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7790>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:53,928 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8430>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:57,135 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8550>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:57,138 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/92d036df508f1742:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832a8700>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8700>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:25:58,201 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8e80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:58,611 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a9030>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:25:59,415 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6500>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:01,045 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f77f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:04,251 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5ff0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:04,255 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/f65be69c40c4d9b9:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5f60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5f60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:05,260 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6530>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:05,663 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5630>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:06,467 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5570>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:08,072 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5d80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:11,279 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6c50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:11,282 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/f65be69c40c4d9b9:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6410>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6410>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:12,288 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5ed0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:12,693 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f56c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:13,497 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6ce0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:15,102 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f60b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:18,309 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6e30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:18,313 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/f65be69c40c4d9b9:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6e00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6e00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:19,339 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f4b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:19,744 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:20,547 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5780>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:21,425 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:26:21.418+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:26:22,152 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:25,359 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f78e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:25,362 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/ce509455fc0059a3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7340>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7340>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:26,368 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f77f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:26,773 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6320>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:27,579 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6140>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:29,183 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977a9a650>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:32,390 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250760>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:32,393 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/ce509455fc0059a3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832508b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832508b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:33,398 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250e80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:33,801 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251270>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:34,608 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832506a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:36,213 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977a98130>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:39,421 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5f60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:39,424 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/ce509455fc0059a3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5450>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5450>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:40,485 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f62f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:40,889 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6290>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:41,693 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f79a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:43,298 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7220>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:46,505 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f72e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:46,508 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/6b2a23268a73c76c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:47,514 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f58d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:47,917 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250790>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:48,721 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250ac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:50,326 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251bd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:51,459 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:26:51.458+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:26:53,533 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252bc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:53,535 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/6b2a23268a73c76c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983250ee0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250ee0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:26:54,541 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5630>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:54,944 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f74f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:55,749 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5690>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:26:57,355 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6560>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:00,562 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5150>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:00,565 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/6b2a23268a73c76c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f73a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f73a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:01,610 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250e20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:02,014 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253a00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:02,818 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250ca0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:04,424 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251a80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:07,633 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251630>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:07,636 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/1f267a354a72a4e7:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252350>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252350>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:08,642 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252b90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:09,045 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251ae0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:09,849 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda5bc95ab0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:11,455 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7490>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:14,662 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:14,665 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/1f267a354a72a4e7:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7af0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7af0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:15,670 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f77f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:16,073 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7280>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:16,884 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5bd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:18,489 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7340>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:21,493 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:27:21.492+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:27:21,695 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6470>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:21,698 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/1f267a354a72a4e7:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983250f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:22,777 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252740>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:23,181 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250e20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:23,985 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252560>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:25,589 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832517e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:28,795 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253eb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:28,799 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/025a294cb7c8deb9:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253190>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253190>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:29,805 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7340>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:30,210 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5870>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:31,013 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5960>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:32,618 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6d10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:35,824 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7670>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:35,827 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/025a294cb7c8deb9:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f6050>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6050>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:36,833 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:37,237 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252c20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:38,041 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253040>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:39,645 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253ac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:42,851 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253820>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:42,854 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/025a294cb7c8deb9:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253d60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:43,909 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a1810>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:44,313 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832796f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:45,117 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cfb80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:46,723 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251300>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:49,930 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:49,932 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/cfb13747ae0e0cb3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253d30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:50,938 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253220>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:51,341 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7190>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:51,522 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:27:51.520+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:27:52,145 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:53,750 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:56,961 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6290>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:56,965 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/cfb13747ae0e0cb3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f78e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f78e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:27:57,970 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7340>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:58,374 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7790>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:27:59,177 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6c80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:00,783 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:03,989 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b370>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:04,019 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/cfb13747ae0e0cb3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b610>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:05,101 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6b60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:05,504 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6800>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:06,308 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983250be0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:07,913 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253100>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:11,120 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252aa0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:11,124 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b6322baf3513cc7c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252f80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252f80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:12,149 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cca60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:12,554 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278c70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:13,358 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832795a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:14,963 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278640>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:18,170 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832789a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:18,174 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b6322baf3513cc7c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b760>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b760>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:19,181 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279ba0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:19,585 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ac50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:20,390 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cf190>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:21,555 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:28:21.553+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:28:21,995 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:25,201 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253970>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:25,205 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/b6322baf3513cc7c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253d30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:26,269 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832529b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:26,672 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6500>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:27,476 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7850>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:29,081 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6e90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:32,287 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6fb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:32,290 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c0ef4bc6c2a0f9b3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f7250>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7250>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:33,296 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b7c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:33,699 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327baf0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:34,503 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279150>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:36,108 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ae60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:39,313 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:39,317 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c0ef4bc6c2a0f9b3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983279ab0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279ab0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:40,324 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7940>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:40,729 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7040>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:41,533 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252fe0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:43,138 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832514e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:46,343 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252c50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:46,346 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c0ef4bc6c2a0f9b3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252cb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252cb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:47,398 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cfb80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:47,801 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b2b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:48,605 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832799c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:50,210 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832793c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:51,589 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:28:51.587+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:28:53,417 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278100>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:53,420 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/22c06aa0e6516e6c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832782b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832782b0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:28:54,424 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a8c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:54,828 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a710>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:55,632 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cd930>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:28:57,237 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253c10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:00,443 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252e60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:00,446 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/22c06aa0e6516e6c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253f40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253f40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:01,451 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252fe0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:01,855 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5150>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:02,658 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5840>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:04,263 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6dd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:07,470 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f6e90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:07,472 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/22c06aa0e6516e6c:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832f5bd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5bd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:08,555 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278f10>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:08,959 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b010>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:09,763 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278c40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:11,369 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278a90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:14,576 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279600>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:14,580 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/4f3261fe1a7f1238:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327ab90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ab90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:15,586 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f5840>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:15,991 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832f7bb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:16,795 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:18,400 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253850>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:21,607 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252e90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:21,610 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/4f3261fe1a7f1238:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983252cb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252cb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:21,623 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:29:21.622+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:29:22,615 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd977a9a650>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:23,018 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279810>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:23,822 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a890>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:25,427 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a9090>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:28,634 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8520>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:28,638 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/4f3261fe1a7f1238:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832a8730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a8730>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:29,715 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a95d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:30,123 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832a9780>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:30,927 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cd930>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:32,532 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a2f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:35,738 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279750>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:35,741 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/596855739f78b1b2:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327a0e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a0e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:36,749 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278940>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:37,152 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a650>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:37,957 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832799c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:39,562 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832792d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:42,769 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832781c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:42,772 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/596855739f78b1b2:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278fa0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278fa0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:43,777 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278fd0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:44,181 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ad40>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:44,985 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278b20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:46,590 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279540>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:49,795 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279450>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:49,799 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/596855739f78b1b2:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327b1c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b1c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:50,860 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:51,264 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279240>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:51,657 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:29:51.656+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:29:52,068 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278ee0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:53,673 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278310>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:56,878 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a4a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:56,881 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/95522d58a8a9d77a:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278400>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278400>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:29:57,887 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832798d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:58,290 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279900>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:29:59,094 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b7c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:00,699 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832789d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:03,903 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b7f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:03,907 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/95522d58a8a9d77a:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983279a50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279a50>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:30:04,912 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832787f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:05,315 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b4f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:06,120 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b400>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:07,723 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cfac0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:10,929 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ab60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:10,932 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/95522d58a8a9d77a:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd98327ab00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ab00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:30:11,968 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832784c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:12,371 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a2f0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:13,174 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b0a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:14,776 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a6e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:17,984 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832790c0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:17,986 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c2756e797ce2acf3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278070>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278070>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:30:18,990 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279300>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:19,392 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983279f60>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:20,195 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ab90>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:21,691 INFO     16 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-01T21:30:21.689+08:00", "boot_at": "2025-03-01T18:09:38.267+08:00", "pending": 1, "lag": 2, "done": 5, "failed": 6, "current": {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811125, "task_type": ""}}
2025-03-01 21:30:21,799 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a2560>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:25,004 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda604a2f20>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:25,006 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c2756e797ce2acf3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd9832533d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832533d0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:30:26,011 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278070>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:26,413 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327abf0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:27,217 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327b0a0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:28,820 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832797e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:32,026 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327ba00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:32,027 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/c2756e797ce2acf3:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983278dc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983278dc0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:30:33,069 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d30>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:33,471 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253d00>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:34,274 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253df0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:35,878 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983252cb0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:39,083 WARNING  16 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd9832532e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:39,085 ERROR    16 Fail to put d8fa77c8f67211efbb120242ac120006/2b1070f54c4cf62d:
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7fd983253b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/rag/utils/minio_conn.py", line 66, in put
    if not self.conn.bucket_exists(bucket):
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 696, in bucket_exists
    self._execute("HEAD", bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 437, in _execute
    region = self._get_region(bucket_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 494, in _get_region
    response = self._url_open(
  File "/ragflow/.venv/lib/python3.10/site-packages/minio/api.py", line 302, in _url_open
    response = self._http.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='minio', port=9000): Max retries exceeded with url: /d8fa77c8f67211efbb120242ac120006?location= (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983253b80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)"))
2025-03-01 21:30:40,089 WARNING  16 Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251b70>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:40,492 WARNING  16 Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd983251840>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:41,295 WARNING  16 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fda225cfb80>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-01 21:30:42,899 WARNING  16 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7fd98327a3e0>: Failed to resolve 'minio' ([Errno -3] Temporary failure in name resolution)")': /d8fa77c8f67211efbb120242ac120006?location=
2025-03-03 08:30:08,512 INFO     28 task_executor_0 log path: /ragflow/logs/task_executor_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2025-03-03 08:30:08,986 INFO     28 init database on cluster mode successfully
2025-03-03 08:30:16,764 INFO     28 TextRecognizer det uses CPU
2025-03-03 08:30:16,875 INFO     28 TextRecognizer rec uses CPU
2025-03-03 08:30:16,900 INFO     28 
  ______           __      ______                     __            
 /_  __/___ ______/ /__   / ____/  _____  _______  __/ /_____  _____
  / / / __ `/ ___/ //_/  / __/ | |/_/ _ \/ ___/ / / / __/ __ \/ ___/
 / / / /_/ (__  ) ,<    / /____>  </  __/ /__/ /_/ / /_/ /_/ / /    
/_/  \__,_/____/_/|_|  /_____/_/|_|\___/\___/\__,_/\__/\____/_/                               
    
2025-03-03 08:30:16,902 INFO     28 TaskExecutor: RAGFlow version: v0.16.0 slim
2025-03-03 08:30:16,903 INFO     28 Use Elasticsearch http://es01:9200 as the doc engine.
2025-03-03 08:30:16,912 INFO     28 GET http://es01:9200/ [status:200 duration:0.007s]
2025-03-03 08:30:16,916 INFO     28 HEAD http://es01:9200/ [status:200 duration:0.003s]
2025-03-03 08:30:16,917 INFO     28 Elasticsearch http://es01:9200 is healthy.
2025-03-03 08:30:16,921 WARNING  28 Load term.freq FAIL!
2025-03-03 08:30:16,924 WARNING  28 Realtime synonym is disabled, since no redis connection.
2025-03-03 08:30:16,928 WARNING  28 Load term.freq FAIL!
2025-03-03 08:30:16,931 WARNING  28 Realtime synonym is disabled, since no redis connection.
2025-03-03 08:30:16,932 INFO     28 MAX_CONTENT_LENGTH: 134217728
2025-03-03 08:30:16,933 INFO     28 SERVER_QUEUE_MAX_LEN: 1024
2025-03-03 08:30:16,933 INFO     28 SERVER_QUEUE_RETENTION: 3600
2025-03-03 08:30:16,934 INFO     28 MAX_FILE_COUNT_PER_USER: 0
2025-03-03 08:30:16,960 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:30:16.958+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 1, "lag": 2, "done": 0, "failed": 0, "current": null}
2025-03-03 08:30:16,977 INFO     28 handle_task begin for task {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 1, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740833493656, "task_type": ""}
2025-03-03 08:30:17,152 INFO     28 set_progress(50a3ef30f69a11ef85610242ac120006), progress: -1, progress_msg: 08:30:17 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:30:17,167 ERROR    28 handle_task got exception for task {"id": "50a3ef30f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 1, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740833493656, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:30:17,202 INFO     28 handle_task begin for task {"id": "50a3efa8f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 60, "to_page": 72, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811126, "task_type": ""}
2025-03-03 08:30:17,219 INFO     28 set_progress(50a3efa8f69a11ef85610242ac120006), progress: -1, progress_msg: 08:30:17 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:30:17,231 ERROR    28 handle_task got exception for task {"id": "50a3efa8f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 60, "to_page": 72, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811126, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:30:17,244 INFO     28 handle_task begin for task {"id": "50a3f016f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 72, "to_page": 76, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811127, "task_type": ""}
2025-03-03 08:30:17,303 INFO     28 set_progress(50a3f016f69a11ef85610242ac120006), progress: -1, progress_msg: 08:30:17 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:30:17,314 ERROR    28 handle_task got exception for task {"id": "50a3f016f69a11ef85610242ac120006", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 72, "to_page": 76, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740832811127, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:30:46,994 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:30:46.993+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 3, "current": null}
2025-03-03 08:31:17,000 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:31:16.999+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 3, "current": null}
2025-03-03 08:31:47,032 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:31:47.031+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 3, "current": null}
2025-03-03 08:32:17,063 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:32:17.062+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 3, "current": null}
2025-03-03 08:32:47,095 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:32:47.094+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 3, "current": null}
2025-03-03 08:33:17,126 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:33:17.125+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 3, "current": null}
2025-03-03 08:33:21,293 INFO     28 handle_task begin for task {"id": "1c0515d2f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001258, "task_type": ""}
2025-03-03 08:33:21,441 INFO     28 set_progress(1c0515d2f7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,453 ERROR    28 handle_task got exception for task {"id": "1c0515d2f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001258, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,468 INFO     28 handle_task begin for task {"id": "1c051938f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001259, "task_type": ""}
2025-03-03 08:33:21,490 INFO     28 set_progress(1c051938f7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,506 ERROR    28 handle_task got exception for task {"id": "1c051938f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 12, "to_page": 24, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001259, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,518 INFO     28 handle_task begin for task {"id": "1c0519cef7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001260, "task_type": ""}
2025-03-03 08:33:21,539 INFO     28 set_progress(1c0519cef7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,553 ERROR    28 handle_task got exception for task {"id": "1c0519cef7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 24, "to_page": 36, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001260, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,567 INFO     28 handle_task begin for task {"id": "1c051a3cf7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001261, "task_type": ""}
2025-03-03 08:33:21,588 INFO     28 set_progress(1c051a3cf7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,602 ERROR    28 handle_task got exception for task {"id": "1c051a3cf7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 36, "to_page": 48, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001261, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,616 INFO     28 handle_task begin for task {"id": "1c051ab4f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001262, "task_type": ""}
2025-03-03 08:33:21,638 INFO     28 set_progress(1c051ab4f7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,654 ERROR    28 handle_task got exception for task {"id": "1c051ab4f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 48, "to_page": 60, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001262, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,667 INFO     28 handle_task begin for task {"id": "1c051b18f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 60, "to_page": 72, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001263, "task_type": ""}
2025-03-03 08:33:21,687 INFO     28 set_progress(1c051b18f7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,708 ERROR    28 handle_task got exception for task {"id": "1c051b18f7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 60, "to_page": 72, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001263, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,722 INFO     28 handle_task begin for task {"id": "1c051b7cf7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 72, "to_page": 76, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001264, "task_type": ""}
2025-03-03 08:33:21,743 INFO     28 set_progress(1c051b7cf7c711ef974f0242ac120004), progress: -1, progress_msg: 08:33:21 [ERROR][Exception]: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:21,757 ERROR    28 handle_task got exception for task {"id": "1c051b7cf7c711ef974f0242ac120004", "doc_id": "6acd6bbaf68711efb3030242ac120006", "from_page": 72, "to_page": 76, "retry_count": 0, "kb_id": "d8fa77c8f67211efbb120242ac120006", "parser_id": "naive", "parser_config": {"pages": [[1, 1000000]], "layout_recognize": "DeepDOC", "task_page_size": 12, "auto_keywords": 0, "auto_questions": 0, "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 3}, "graphrag": {"use_graphrag": false}, "chunk_token_num": 128, "delimiter": "\\n!?;\u3002\uff1b\uff01\uff1f"}, "name": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "type": "pdf", "location": "20230314-\u667a\u80fd\u5bb6\u5c45\u884c\u4e1a\uff1a2025\u4e2d\u56fd\u9ad8\u7aef\u667a\u80fd\u5bb6\u5c45\u751f\u6d3b\u573a\u666f\u767d\u76ae\u4e66.pdf", "size": 2853364, "tenant_id": "ca473450f67211efae920242ac120006", "language": "English", "embd_id": "", "pagerank": 0, "kb_parser_config": {"pages": [[1, 1000000]]}, "img2txt_id": "deepseek-ai/Janus-Pro-7B@SILICONFLOW", "asr_id": "", "llm_id": "deepseek-ai/DeepSeek-R1-Distill-Llama-70B@SILICONFLOW", "update_time": 1740962001264, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 460, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 504, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1100, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1371, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/ragflow/.venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 626, in handle_task
    do_handle_task(task)
  File "/ragflow/rag/svr/task_executor.py", line 489, in do_handle_task
    vts, _ = embedding_model.encode(["ok"])
  File "<@beartype(api.db.services.llm_service.LLMBundle.encode) at 0x7f6f17993910>", line 31, in encode
  File "/ragflow/api/db/services/llm_service.py", line 238, in encode
    embeddings, used_tokens = self.mdl.encode(texts)
  File "<@beartype(rag.llm.embedding_model.SILICONFLOWEmbed.encode) at 0x7f6f18a08a60>", line 31, in encode
  File "/ragflow/rag/llm/embedding_model.py", line 688, in encode
    res = requests.post(self.base_url, json=payload, headers=self.headers).json()
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/ragflow/.venv/lib/python3.10/site-packages/requests/adapters.py", line 620, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Max retries exceeded with url: /v1/embeddings (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))
2025-03-03 08:33:47,159 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:33:47.157+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:34:17,195 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:34:17.194+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:34:47,231 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:34:47.230+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:35:17,262 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:35:17.261+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:35:47,294 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:35:47.293+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:36:17,326 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:36:17.325+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:36:47,357 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:36:47.356+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:37:17,389 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:37:17.388+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:37:47,419 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:37:47.419+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:38:17,441 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:38:17.440+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
2025-03-03 08:38:47,472 INFO     28 task_consumer_0 reported heartbeat: {"name": "task_consumer_0", "now": "2025-03-03T08:38:47.471+08:00", "boot_at": "2025-03-03T08:30:16.900+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 10, "current": null}
